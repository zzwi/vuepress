<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>JavaScript模块化 | Zzwi&#39;s blog</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/img/favicon.ico">
    <script data-ad-client="ca-pub-7828333725993554" async="async" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <meta name="description" content="Zzwi的web前端技术博客,简洁至上,专注web前端学习与总结。JavaScript,js,ES6,TypeScript,vue,python,css3,html5,Node,git,github等技术文章。">
    <meta name="keywords" content="前端博客,个人技术博客,前端,前端开发,前端框架,web前端,前端面试题,技术文档,学习,面试,JavaScript,js,ES6,TypeScript,vue,python,css3,html5,Node,git,github,markdown">
    <meta name="baidu-site-verification" content="7F55weZDDc">
    <meta name="theme-color" content="#11a8cd">
    <link rel="preload" href="/assets/css/0.styles.546f0649.css" as="style"><link rel="preload" href="/assets/js/app.440246d8.js" as="script"><link rel="preload" href="/assets/js/2.4c3fdaa0.js" as="script"><link rel="preload" href="/assets/js/56.1c1815b6.js" as="script"><link rel="prefetch" href="/assets/js/10.07cd4bc0.js"><link rel="prefetch" href="/assets/js/11.584c59cc.js"><link rel="prefetch" href="/assets/js/12.73d1105b.js"><link rel="prefetch" href="/assets/js/13.36121d5e.js"><link rel="prefetch" href="/assets/js/14.fabe3797.js"><link rel="prefetch" href="/assets/js/15.41f743aa.js"><link rel="prefetch" href="/assets/js/16.1685fe06.js"><link rel="prefetch" href="/assets/js/17.6f5fc7cb.js"><link rel="prefetch" href="/assets/js/18.e93038d0.js"><link rel="prefetch" href="/assets/js/19.3ed90a9b.js"><link rel="prefetch" href="/assets/js/20.9e2678b7.js"><link rel="prefetch" href="/assets/js/21.5f923aaa.js"><link rel="prefetch" href="/assets/js/22.025cd7e9.js"><link rel="prefetch" href="/assets/js/23.5cd3878a.js"><link rel="prefetch" href="/assets/js/24.ccb9958a.js"><link rel="prefetch" href="/assets/js/25.8adef4b3.js"><link rel="prefetch" href="/assets/js/26.83073ffa.js"><link rel="prefetch" href="/assets/js/27.cf3451c9.js"><link rel="prefetch" href="/assets/js/28.33d2fba7.js"><link rel="prefetch" href="/assets/js/29.a658c9fb.js"><link rel="prefetch" href="/assets/js/3.87648ed6.js"><link rel="prefetch" href="/assets/js/30.7aeac9fb.js"><link rel="prefetch" href="/assets/js/31.c10d5cd9.js"><link rel="prefetch" href="/assets/js/32.dd835864.js"><link rel="prefetch" href="/assets/js/33.f677751e.js"><link rel="prefetch" href="/assets/js/34.ad0b95fc.js"><link rel="prefetch" href="/assets/js/35.04211931.js"><link rel="prefetch" href="/assets/js/36.6688fb3d.js"><link rel="prefetch" href="/assets/js/37.29d02e68.js"><link rel="prefetch" href="/assets/js/38.bfe75210.js"><link rel="prefetch" href="/assets/js/39.22b7768f.js"><link rel="prefetch" href="/assets/js/4.3861cf58.js"><link rel="prefetch" href="/assets/js/40.3fccc8d8.js"><link rel="prefetch" href="/assets/js/41.45c98daf.js"><link rel="prefetch" href="/assets/js/42.1eb08949.js"><link rel="prefetch" href="/assets/js/43.00c0ecd2.js"><link rel="prefetch" href="/assets/js/44.1ff71e39.js"><link rel="prefetch" href="/assets/js/45.0dec8d70.js"><link rel="prefetch" href="/assets/js/46.bca55039.js"><link rel="prefetch" href="/assets/js/47.bb08e056.js"><link rel="prefetch" href="/assets/js/48.096e788d.js"><link rel="prefetch" href="/assets/js/49.d5e4bc1a.js"><link rel="prefetch" href="/assets/js/5.2a529840.js"><link rel="prefetch" href="/assets/js/50.a1f32cdd.js"><link rel="prefetch" href="/assets/js/51.1fb4370c.js"><link rel="prefetch" href="/assets/js/52.7e5ddda0.js"><link rel="prefetch" href="/assets/js/53.288b6d2d.js"><link rel="prefetch" href="/assets/js/54.6687b63d.js"><link rel="prefetch" href="/assets/js/55.e60b8f00.js"><link rel="prefetch" href="/assets/js/57.fd1d9b37.js"><link rel="prefetch" href="/assets/js/58.c57482f8.js"><link rel="prefetch" href="/assets/js/59.63a82470.js"><link rel="prefetch" href="/assets/js/6.9f32ec73.js"><link rel="prefetch" href="/assets/js/60.3a593257.js"><link rel="prefetch" href="/assets/js/61.06a65d16.js"><link rel="prefetch" href="/assets/js/62.8ae4a93d.js"><link rel="prefetch" href="/assets/js/63.4dbe4c03.js"><link rel="prefetch" href="/assets/js/64.52b60d2a.js"><link rel="prefetch" href="/assets/js/65.bc4ec65c.js"><link rel="prefetch" href="/assets/js/66.e7e9e363.js"><link rel="prefetch" href="/assets/js/67.05c9700f.js"><link rel="prefetch" href="/assets/js/68.134ab88f.js"><link rel="prefetch" href="/assets/js/69.f231cf2b.js"><link rel="prefetch" href="/assets/js/7.590d37c9.js"><link rel="prefetch" href="/assets/js/70.be6e1328.js"><link rel="prefetch" href="/assets/js/8.e8e515c8.js"><link rel="prefetch" href="/assets/js/9.957f4a19.js">
    <link rel="stylesheet" href="/assets/css/0.styles.546f0649.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/zzwi-logo.jpg" alt="Zzwi's blog" class="logo"> <span class="site-name can-hide">Zzwi's blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><a href="/web/" class="link-title">前端</a> <span class="title" style="display:none;">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>学习笔记</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/note/css/" class="nav-link">CSS</a></li><li class="dropdown-subitem"><a href="/note/javascript/" class="nav-link">JavaScript</a></li><li class="dropdown-subitem"><a href="/note/vue/" class="nav-link">Vue</a></li></ul></li><li class="dropdown-item"><h4>踩坑记录</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/record/html/" class="nav-link">HTML的踩坑之路</a></li><li class="dropdown-subitem"><a href="/record/vue/" class="nav-link">Vue的踩坑之路</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="更多" class="dropdown-title"><a href="/more/" class="link-title">更多</a> <span class="title" style="display:none;">更多</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/friends/" class="nav-link">友情链接</a></li></ul></div></div><div class="nav-item"><a href="/about/" class="nav-link">关于</a></div><div class="nav-item"><a href="/pages/beb6c0bd8a66cea6/" class="nav-link">收藏</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">归档</a></li></ul></div></div> <a href="https://github.com/zzwi" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="https://cdn.jsdelivr.net/gh/zzwi/mycdn/source/images/avatar.png"> <div class="blogger-info"><h3>Zzwi</h3> <span>前端小白</span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><a href="/web/" class="link-title">前端</a> <span class="title" style="display:none;">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>学习笔记</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/note/css/" class="nav-link">CSS</a></li><li class="dropdown-subitem"><a href="/note/javascript/" class="nav-link">JavaScript</a></li><li class="dropdown-subitem"><a href="/note/vue/" class="nav-link">Vue</a></li></ul></li><li class="dropdown-item"><h4>踩坑记录</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/record/html/" class="nav-link">HTML的踩坑之路</a></li><li class="dropdown-subitem"><a href="/record/vue/" class="nav-link">Vue的踩坑之路</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="更多" class="dropdown-title"><a href="/more/" class="link-title">更多</a> <span class="title" style="display:none;">更多</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/friends/" class="nav-link">友情链接</a></li></ul></div></div><div class="nav-item"><a href="/about/" class="nav-link">关于</a></div><div class="nav-item"><a href="/pages/beb6c0bd8a66cea6/" class="nav-link">收藏</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">归档</a></li></ul></div></div> <a href="https://github.com/zzwi" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>基础</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>JS高级</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/cc55f1/" class="sidebar-link">浏览器原理-v8引擎-js执行原理</a></li><li><a href="/pages/013e05/" class="sidebar-link">JavaScript内存管理</a></li><li><a href="/pages/215992/" class="sidebar-link">JavaScript闭包</a></li><li><a href="/pages/18c561/" class="sidebar-link">JavaScript函数的this指向</a></li><li><a href="/pages/e0895c/" class="sidebar-link">call_apply_bind的简单实现</a></li><li><a href="/pages/782fdd/" class="sidebar-link">纯函数_柯里化_组合函数</a></li><li><a href="/pages/1b8726/" class="sidebar-link">with_eval_strict的简单了解</a></li><li><a href="/pages/44fada/" class="sidebar-link">面向对象</a></li><li><a href="/pages/516888/" class="sidebar-link">JS原型链和继承</a></li><li><a href="/pages/58df7a/" class="sidebar-link">ES6中类的使用</a></li><li><a href="/pages/3ed999/" class="sidebar-link">面向对象的补充</a></li><li><a href="/pages/65b6fa/" class="sidebar-link">ES6知识点(part1)</a></li><li><a href="/pages/74195d/" class="sidebar-link">ES6知识点(part2)</a></li><li><a href="/pages/a72c57/" class="sidebar-link">ES6知识点(part3)</a></li><li><a href="/pages/47e19b/" class="sidebar-link">ES7~ES8知识点</a></li><li><a href="/pages/8932ff/" class="sidebar-link">ES9~ES10知识点</a></li><li><a href="/pages/9ca128/" class="sidebar-link">ES11~ES12知识点</a></li><li><a href="/pages/ca4444/" class="sidebar-link">Proxy-Reflect</a></li><li><a href="/pages/bb9b29/" class="sidebar-link">Promise使用详解</a></li><li><a href="/pages/d6f9b3/" class="sidebar-link">简单手写Promise</a></li><li><a href="/pages/12b963/" class="sidebar-link">Iterator-Generator</a></li><li><a href="/pages/6147c6/" class="sidebar-link">async-await</a></li><li><a href="/pages/a4ec2b/" class="sidebar-link">异常处理</a></li><li><a href="/pages/31a8cb/" aria-current="page" class="active sidebar-link">JavaScript模块化</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/31a8cb/#什么是模块化" class="sidebar-link">什么是模块化</a></li><li class="sidebar-sub-header"><a href="/pages/31a8cb/#模块化的历史" class="sidebar-link">模块化的历史</a></li><li class="sidebar-sub-header"><a href="/pages/31a8cb/#模块化的雏形" class="sidebar-link">模块化的雏形</a></li><li class="sidebar-sub-header"><a href="/pages/31a8cb/#commonjs规范" class="sidebar-link">CommonJS规范</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/31a8cb/#exports导出" class="sidebar-link">exports导出</a></li><li class="sidebar-sub-header"><a href="/pages/31a8cb/#module-exports" class="sidebar-link">module.exports</a></li><li class="sidebar-sub-header"><a href="/pages/31a8cb/#require细节" class="sidebar-link">require细节</a></li><li class="sidebar-sub-header"><a href="/pages/31a8cb/#模块加载细节" class="sidebar-link">模块加载细节</a></li><li class="sidebar-sub-header"><a href="/pages/31a8cb/#模块加载顺序" class="sidebar-link">模块加载顺序</a></li><li class="sidebar-sub-header"><a href="/pages/31a8cb/#commonjs规范缺点" class="sidebar-link">CommonJS规范缺点</a></li></ul></li><li class="sidebar-sub-header"><a href="/pages/31a8cb/#amd规范" class="sidebar-link">AMD规范</a></li><li class="sidebar-sub-header"><a href="/pages/31a8cb/#cmd规范" class="sidebar-link">CMD规范</a></li><li class="sidebar-sub-header"><a href="/pages/31a8cb/#esmodule" class="sidebar-link">ESModule</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/31a8cb/#结构组件" class="sidebar-link">结构组件</a></li><li class="sidebar-sub-header"><a href="/pages/31a8cb/#export关键字" class="sidebar-link">export关键字</a></li><li class="sidebar-sub-header"><a href="/pages/31a8cb/#import关键字" class="sidebar-link">import关键字</a></li><li class="sidebar-sub-header"><a href="/pages/31a8cb/#export和import" class="sidebar-link">export和import</a></li><li class="sidebar-sub-header"><a href="/pages/31a8cb/#default用法" class="sidebar-link">default用法</a></li><li class="sidebar-sub-header"><a href="/pages/31a8cb/#import函数" class="sidebar-link">import函数</a></li><li class="sidebar-sub-header"><a href="/pages/31a8cb/#import-meta" class="sidebar-link">import meta</a></li><li class="sidebar-sub-header"><a href="/pages/31a8cb/#内部原理" class="sidebar-link">内部原理</a></li></ul></li><li class="sidebar-sub-header"><a href="/pages/31a8cb/#参考" class="sidebar-link">参考</a></li></ul></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>JavaScript错题集</span> <span class="arrow right"></span></p> <!----></section></li></ul> <div class="sidebar-slot sidebar-slot-bottom"><!-- 正方形 -->
      <ins class="adsbygoogle"
          style="display:block"
          data-ad-client="ca-pub-7828333725993554"
          data-ad-slot="3508773082"
          data-ad-format="auto"
          data-full-width-responsive="true"></ins>
      <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
      </script></div></aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-1cd794fe><div class="articleInfo" data-v-1cd794fe><ul class="breadcrumbs" data-v-1cd794fe><li data-v-1cd794fe><a href="/" title="首页" class="iconfont icon-home router-link-active" data-v-1cd794fe></a></li> <li data-v-1cd794fe><a href="/note/javascript/" title="JavaScript笔记-目录页" data-v-1cd794fe>JavaScript笔记</a></li> <li data-v-1cd794fe><a href="/note/javascript//#JS高级" title="JavaScript笔记#JS高级" data-v-1cd794fe>JS高级</a></li> <!----></ul> <div class="info" data-v-1cd794fe><div title="作者" class="author iconfont icon-touxiang" data-v-1cd794fe><a href="https://github.com/zzwi" target="_blank" title="作者" class="beLink" data-v-1cd794fe>zzwi</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-1cd794fe><a href="javascript:;" data-v-1cd794fe>2022-04-05</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABH1JREFUSA3tVl1oHFUUPmdmd2ltklqbpJDiNnXFmgbFktho7YMPNiJSSZM0+CAYSkUELVhM6YuwIPpgoOKDqOBDC0XE2CQoNtQXBUFTTcCi+Wlh1V2TQExsUzcltd3M9Tt3ZjZzZ2fT+OJTL8yeM+eee757fmeJbq//KQL8X3DUSFOcfr7cRsRtxNQMWueeVzOkaITIGqQHNg5y8+jNW9ldM7A6nTpAjuolUikAwq7CE3WcM2RRDz+XGVgN3FptU/aUSlvq9Pa3iZ1+sgAqJyyAFqkipd9dqiwHF3P65YycLWc/6sqGrvoEoIp6DOFaX5h6+dnfjkWprwqsPk0dUGq5vySwDImC10KxFHgGL1SWoc92O3eVht09qdXNH11I2SsTsJYqMWzihqGMi+A+Garf3BAuuLI5oGlULyNfyB/HYNujwktOfRrMr5t77NmevqaUopx0grnKAyvVpmwUDB4x6FPXuGvYLTDwWsejwgtgkYKPqRJg8SV6xaiZ3ZTppGneS4yfH5/66fZSDHv+QZci/+h5c5UHtpy67JUqGppM0sh0Nc1dW6/N1W5Yoqat8/TU/VnadmdeW2PLLSyh0cvxBs3KbqTmwYPpxN4do/mzE8nEpvX/UMu2Wbp74zUAK5q6WkHns7V0eWkdPbPzd3rxkTGybadYySumVzhcaJFbs5UrEkQ/+CK8gF5dnh/6ciIZ73gwQ927L1IitoxKLXYP3SjYdOrHHfTZhRRlFyrorafPk20B3HPD1y2G3qKZME5Jcf3t/HUC13/8tSd++vqFveMUTwAUxSUFI1QekR1+bIze3D9MF2aq6cPvG72CgnldWCFqyRw3lwH8ZMerjTD9ElRO7Gv44wNpC90aASqGfVlz/Rx17srQ57/UU26hkhQqUB7dBR71WmzQhHUnblGmVOEw0jhbV1n9OlXUDCIRGaNV5Jp43N516fN7JmnTHdfp7Hgy0luO4aMhtkLL8Bi3bUWYvzh5Mn1dTxrL6QmGuRhGL/TiTTxRoEdTszSaq9GR0NGA3KdkOz3hqSV3MIDhQ5IVX/Ivx3umBti2es2h4eZby7x8br1rkf7Mo90AqC8aQ3sJeNzqFRu+vSANAQe3PL7l0HGOAdwDCeZYvNKeoZp1Qfs6Aipndh86HmFRi0LAnEO47wsqM6cdfjh3jBPUzhZy7nvlUfFsamED1VQt6aISHVymXZ/B2aCtIG8AI8xfobj2d3en1wWVhOeHELKmLQ1s211s88comkv4UCwWyF787mJdYXtNfhKAXVqnKTq8QZvGAGGOfaTo5pGZ/PwbUCr5+DPr/1J92JNHr9aOl/F3iI5+O1nfybsGxoimvZ3ViWSluDITw3P37mypheDIPY0tw7+O/5ApbkYw+zpfaUVu32Pi98+defdUhEpZkRFq0aqyNh9FuL9hpYbEm6iwi0z2REd09ZmyENEbuhjDWzKvZXTqKYaBIr3tt5kuPtQBZFvEUwHt60vfCNu41XsksH9Ij1BMMz1Y0OOunHNShFIP5868g5zeXmuLwL9T4b6Q2+KejgAAAABJRU5ErkJggg==">
          JavaScript模块化
        </h1> <div class="page-slot page-slot-top"><!-- 固定100% * 90px可显示，max-height:90px未见显示-->
     <ins class="adsbygoogle"
          style="display:inline-block;width:100%;max-height:90px"
          data-ad-client="ca-pub-7828333725993554"
          data-ad-slot="6625304284"></ins>
      <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
      </script></div> <div class="theme-vdoing-content content__default"><h1 id="_24-javascript模块化"><a href="#_24-javascript模块化" class="header-anchor">#</a> 24.JavaScript模块化</h1> <h2 id="什么是模块化"><a href="#什么是模块化" class="header-anchor">#</a> 什么是模块化</h2> <p>到底什么是模块化、模块化开发呢？</p> <ul><li>事实上模块化开发最终的目的是将程序划分成 <strong>一个个小的结构</strong></li> <li>在这个结构中编写属于 <strong>自己的逻辑代码</strong> ，有 <strong>自己的作用域</strong> ，不会影响到其他的结构</li> <li>这个结构可以将自己希望暴露的 <strong>变量、函数、对象</strong> 等导出给其他结构使用</li> <li>也可以通过某种方式，导入其他结构中的 <strong>变量、函数、对象</strong> 等</li></ul> <p>上面所提到的 <strong>结构</strong> ，就是 <strong>模块</strong> ；按照这种 <strong>结构划分</strong> 开发程序的过程，就是 <strong>模块化开发</strong> 的过程</p> <h2 id="模块化的历史"><a href="#模块化的历史" class="header-anchor">#</a> 模块化的历史</h2> <p>在网页开发的早期， <em>Brendan Eich</em> 开发的JavaScript仅仅作为一种 <strong>脚本语言</strong> ，做一些简单的表单验证或动画实现等，那个时候代码还是很少的：</p> <ul><li>这个时候我们只需要将JavaScript代码写到 <code>&lt;script&gt;</code> 标签中即可</li> <li>并没有必要放到多个文件中来编写，甚至流行，通常来说JavaScript程序的长度只有一行</li></ul> <p>但是随着前端和JavaScript的快速发展，JavaScript代码变得越来越复杂了：</p> <ul><li>ajax的出现， <strong>前后端开发分离</strong> ，意味着后端返回数据后，我们需要通过 <strong>JavaScript进行前端页面的渲染</strong> ；</li> <li>SPA的出现，前端页面变得更加复杂：包括 <strong>前端路由、状态管理</strong> 等等一系列复杂的需求需要通过JavaScript来实现；</li> <li>包括Node的实现，JavaScript编写 <strong>复杂的后端程序</strong> ，没有模块化是致命的硬伤</li></ul> <p>所以，模块化已经是JavaScript一个非常迫切的需求：</p> <ul><li>但是JavaScript本身，直到ES6(2015)才推出了自己的模块化方案</li> <li>在此之前，为了让JavaScript支持模块化，涌现出了很多不同的模块化规范：AMD、CMD、CommonJS等</li></ul> <h2 id="模块化的雏形"><a href="#模块化的雏形" class="header-anchor">#</a> 模块化的雏形</h2> <p>早起没有模块化带来了很多的问题：比如命名冲突的问题</p> <p>当然，我们有办法可以解决上面的问题：立即函数调用表达式(IIFE)</p> <ul><li><strong>IIFE</strong> (Immediately Invoked Function Expression)</li></ul> <p>如下代码所示：</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token comment">&lt;!-- index.html --&gt;</span>
<span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>en<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>UTF-8<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>X-UA-Compatible<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>IE=edge<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>viewport<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>width=device-width, initial-scale=1.0<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>模块化的雏形<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>./export.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>./main.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// export.js</span>
<span class="token comment">// IIFE</span>
<span class="token keyword">const</span> moduleA <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> name <span class="token operator">=</span> <span class="token string">&quot;zzwi&quot;</span>
  <span class="token keyword">var</span> age <span class="token operator">=</span> <span class="token number">18</span>

  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    name<span class="token punctuation">,</span>
    age
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// main.js</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>moduleA<span class="token punctuation">.</span>name<span class="token punctuation">)</span> <span class="token comment">// zzwi</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>moduleA<span class="token punctuation">.</span>age<span class="token punctuation">)</span> <span class="token comment">// 18</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>但是，我们其实带来了新的问题：</p> <ol><li>我必须记得 <strong>每一个模块中返回对象的命名</strong> ，才能在其他模块使用过程中正确的使用；</li> <li>代码写起来 <strong>混乱不堪</strong> ，每个文件中的代码都需要 <strong>包裹在一个匿名函数中来编写</strong> ；</li> <li>在 <strong>没有合适规范</strong> 的情况下，每个人、每个公司都可能会任意命名、甚至出现模块名称相同的情况；</li></ol> <p>所以，我们会发现，虽然实现了模块化，但是我们的实现过于简单，并且是没有规范的。</p> <ul><li>我们需要制定一定的规范来约束每个人都 <strong>按照这个规范去编写模块化的代码</strong> ；</li> <li>这个规范中应该包括核心功能： <strong>模块本身可以导出暴露的属性，模块又可以导入自己需要的属性</strong> ；</li> <li>JavaScript社区为了解决上面的问题，涌现出 <strong>一系列好用的规范</strong> ，接下来我们就学习具有代表性的一些规范。</li></ul> <h2 id="commonjs规范"><a href="#commonjs规范" class="header-anchor">#</a> CommonJS规范</h2> <p>我们需要知道CommonJS是 <strong>一个规范</strong> ，最初提出来是在浏览器以外的地方使用，并且当时被命名为 <strong>ServerJS</strong> ，后来为了体现它的广泛性，修改为 <strong>CommonJS</strong> ，平时我们也会简称为 <strong>CJS</strong> 。</p> <ul><li>Node是CommonJS在服务器端一个具有代表性的实现；</li> <li>Browserify是CommonJS在浏览器中的一种实现；</li> <li>webpack打包工具具备对CommonJS的支持和转换；</li></ul> <p>所以，Node中对CommonJS进行了支持和实现，让我们在开发node的过程中可以方便的进行模块化开发：</p> <ul><li>在Node中 <strong>每一个js文件都是一个单独的模块</strong> ；</li> <li>这个模块中包括 <strong>CommonJS规范的核心变量</strong> ：exports、module.exports、require；</li> <li>我们可以使用这些变量来方便地进行 <strong>模块化开发</strong> ；</li></ul> <p>前面我们提到过模块化的核心是导入和导出，Node中对其进行了实现：</p> <ul><li>exports和module.exports可以负责 <strong>对模块中的内容进行导出</strong> ；</li> <li>require函数可以帮助我们 <strong>导入其他模块(自定义模块、系统模块、第三方库模块)中的内容</strong> ；</li></ul> <p><strong>案例1：</strong></p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// export.js</span>
<span class="token keyword">var</span> name <span class="token operator">=</span> <span class="token string">&quot;zzwi&quot;</span>
<span class="token keyword">var</span> age <span class="token operator">=</span> <span class="token number">18</span>
<span class="token keyword">function</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token parameter">num1<span class="token punctuation">,</span> num2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> num1 <span class="token operator">+</span> num2
<span class="token punctuation">}</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  name<span class="token punctuation">,</span>
  age<span class="token punctuation">,</span>
  sum
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// main.js</span>
<span class="token keyword">var</span> foo <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./export.js'</span><span class="token punctuation">)</span>
<span class="token comment">// var {name,age,sum} = require('./export.js')</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>foo<span class="token punctuation">.</span>name<span class="token punctuation">)</span> <span class="token comment">// zzwi</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>foo<span class="token punctuation">.</span>age<span class="token punctuation">)</span> <span class="token comment">// 18</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>foo<span class="token punctuation">.</span><span class="token function">sum</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 30</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="exports导出"><a href="#exports导出" class="header-anchor">#</a> exports导出</h3> <p>注意：exports是一个对象，我们可以在这个对象中添加很多个属性，添加的属性会导出：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// export.js</span>
exports<span class="token punctuation">.</span>name <span class="token operator">=</span> name
exports<span class="token punctuation">.</span>age <span class="token operator">=</span> age
exports<span class="token punctuation">.</span>sum <span class="token operator">=</span> sum
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>另外一个文件中可以导入：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// main.js</span>
<span class="token keyword">const</span> foo <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./export.js'</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>上面这行完成了什么操作呢？理解下面这段话，Node中的模块化一目了然</p> <ul><li>意味着main中的foo变量等于exports对象</li> <li>也就是require通过各种查找方式，最终找到了exports这个对象</li> <li>并且将这个exports对象赋值给了foo变量</li> <li>foo变量就是exports对象了</li></ul> <p><strong>案例2：</strong></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// export.js</span>
<span class="token keyword">const</span> info <span class="token operator">=</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">&quot;zzwi&quot;</span><span class="token punctuation">,</span>
  age<span class="token operator">:</span> <span class="token number">18</span>
<span class="token punctuation">}</span>
<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>info<span class="token punctuation">.</span>name<span class="token punctuation">)</span> <span class="token comment">// bill</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token number">2000</span><span class="token punctuation">)</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> info
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// main.js</span>
<span class="token keyword">const</span> foo <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./export.js'</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>foo<span class="token punctuation">.</span>name<span class="token punctuation">)</span> <span class="token comment">// zzwi</span>

<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  foo<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&quot;bill&quot;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>在node源码中，exports和module.exports的关系：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 源码</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
exports <span class="token operator">=</span> module<span class="token punctuation">.</span>exports
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><img src="https://s3.bmp.ovh/imgs/2022/04/06/45836c25e2c75161.png" alt="module.exports" style="zoom:75%;"> <h3 id="module-exports"><a href="#module-exports" class="header-anchor">#</a> module.exports</h3> <p>但是Node中我们导出东西的时候，又是经常通过module.exports导出的：</p> <ul><li>module.exports和exports有什么关系或者区别呢？</li></ul> <p>我们追根溯源，通过维基百科中对CommonJS规范的解析：</p> <ul><li>CommonJS中是没有module.exports的概念的；</li> <li>但是为了实现模块的导出，Node中使用的是Module的类，每一个模块都是Module的一个实例，也就是module；</li> <li>所以在Node中真正用于导出的其实根本不是exports，而是module.exports；</li> <li>因为 <strong>module才是导出的真正实现者</strong> ；</li></ul> <p>但是，为什么exports也可以导出呢？</p> <ul><li>这是因为module对象的exports属性是exports对象的一个引用</li> <li>也就是说 module.exports = exports = main中的foo</li></ul> <p>在node源码中，exports和module.exports的关系：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 源码</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
exports <span class="token operator">=</span> module<span class="token punctuation">.</span>exports
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><strong>案例3：</strong></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// export.js</span>
<span class="token keyword">const</span> name <span class="token operator">=</span> <span class="token string">&quot;zzwi&quot;</span>
<span class="token keyword">const</span> age <span class="token operator">=</span> <span class="token number">18</span>
<span class="token keyword">function</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token parameter">num1<span class="token punctuation">,</span> num2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> num1 <span class="token operator">+</span> num2
<span class="token punctuation">}</span>

<span class="token comment">// 这种代码不会进行导出</span>
exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  name<span class="token punctuation">,</span>
  age<span class="token punctuation">,</span>
  sum
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// main.js</span>
<span class="token keyword">const</span> foo <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./export.js'</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>foo<span class="token punctuation">)</span> <span class="token comment">// {}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>案例3中，exports主动改变了指向，因为只有module.exports指向的对象能导出，所以此时exports导出失效。</p> <p><strong>案例4：</strong></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// export.js</span>
<span class="token keyword">const</span> name <span class="token operator">=</span> <span class="token string">&quot;zzwi&quot;</span>
<span class="token keyword">const</span> age <span class="token operator">=</span> <span class="token number">18</span>
<span class="token keyword">function</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token parameter">num1<span class="token punctuation">,</span> num2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> num1 <span class="token operator">+</span> num2
<span class="token punctuation">}</span>

<span class="token comment">// 同样，下列代码不会被导出</span>
exports<span class="token punctuation">.</span>name <span class="token operator">=</span> name
exports<span class="token punctuation">.</span>age <span class="token operator">=</span> age
exports<span class="token punctuation">.</span>sum <span class="token operator">=</span> sum

<span class="token comment">// module.exports发生改变</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token comment">// 最终能被导出的一定是module.exports</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// main.js</span>
<span class="token keyword">const</span> foo <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./export.js'</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>foo<span class="token punctuation">)</span> <span class="token comment">// {}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>在案例4中，exports和module.exports原本指向同一导出对象，此时 <code>exports.name = name</code> 一类的导出是有效的，但是后面module.exports改变了指向，原来的导出对象便失效了，exports没有及时跟进，所以它的导出也失效了。</p> <p>所以，最终能被导出的一定是module.exports。</p> <h3 id="require细节"><a href="#require细节" class="header-anchor">#</a> require细节</h3> <p>我们现在已经知道， <strong>require是一个函数</strong> ，可以帮助我们引入一个文件(模块)中导出的对象。</p> <p>那么，require的查找规则是怎么样的呢？</p> <p><a href="https://nodejs.org/dist/latest-v14.x/docs/api/modules.html" target="_blank" rel="noopener noreferrer">require-点击了解<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>下面是coderwhy老师总结的比较常见的查找规则：require(X)</p> <ol><li><p>X是一个Node核心模块，比如path、http</p> <ul><li>直接返回核心模块，并且停止查找</li></ul></li> <li><p>X是以 ./ 或 ../ 或 /(根目录)开头的</p> <p>第一步：将X当做一个文件在对应的目录下查找</p> <ol><li><p>如果有后缀名，按照后缀名的格式查找对应的文件</p></li> <li><p>如果没有后缀名，会按照如下顺序：</p> <p>1&gt; 直接查找文件X</p> <p>2&gt; 查找X.js文件</p> <p>3&gt; 查找X.json文件</p> <p>4&gt; 查找X.node文件</p></li></ol> <p>第二步：没有找到对应的文件，将X作为一个目录</p> <p>​    查找目录下面的index文件</p> <div class="language- extra-class"><pre><code>1. 查找X/index.js文件
1. 查找X/index.json文件
1. 查找X/index.node文件
</code></pre></div><p>如果没有找到，那么报错：not found</p></li> <li><p>直接是一个X(没有路径)，并且X不是一个核心模块</p> <p>会一层层往上找，直到node_modules文件夹，里面是一些在npm库下载下来的模块。</p> <p>如果没有找到，那么报错：not found</p></li></ol> <h3 id="模块加载细节"><a href="#模块加载细节" class="header-anchor">#</a> 模块加载细节</h3> <p>重复导入文件，该文件的加载次数；</p> <p>导入文件的加载顺序；</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// export.js</span>
<span class="token keyword">const</span> name <span class="token operator">=</span> <span class="token string">&quot;zzwi&quot;</span>
<span class="token keyword">const</span> age <span class="token operator">=</span> <span class="token number">18</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;导入的代码开始执行 &quot;</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  name<span class="token punctuation">,</span>
  age
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// main.js</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;main.js开始执行&quot;</span><span class="token punctuation">)</span>
<span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./export.js'</span><span class="token punctuation">)</span>
<span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./export.js'</span><span class="token punctuation">)</span>
<span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./export.js'</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;main.js结束执行&quot;</span><span class="token punctuation">)</span>
<span class="token comment">/**
main.js开始执行
导入的代码开始执行  zzwi
main.js结束执行
 */</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h3 id="模块加载顺序"><a href="#模块加载顺序" class="header-anchor">#</a> 模块加载顺序</h3> <img src="https://s3.bmp.ovh/imgs/2022/04/08/df49249cc8cc90cf.png" alt="模块加载顺序" style="zoom:75%;"> <p>结论一：模块在被第一次引入时，模块中的js代码会被运行一次</p> <p>结论二：模块被多次引入时，会缓存，最终只加载(运行)一次</p> <ul><li>为什么只会加载运行一次呢？</li> <li>这是因为每个模块对象module都有一个属性：loaded</li> <li>为false表示还没有加载，为true表示已经加载</li></ul> <p>结论三：如果有循环引入，那么加载顺序是什么？</p> <p>如果出现上图模块的引用关系，那么加载顺序是什么呢？</p> <ul><li>这个其实是一种数据结构：图结构</li> <li>图结构在遍历的过程中，有深度优先搜索(DFS, depth first search)和广度优先搜索(BFS, breadth first search)</li> <li>Node采用的是深度优先算法：main -&gt; aaa -&gt; ccc -&gt; ddd -&gt; eee -&gt; bbb</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// aaa.js</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;aaa&quot;</span><span class="token punctuation">)</span>
<span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./ccc'</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// bbb.js</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;bbb&quot;</span><span class="token punctuation">)</span>

<span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./ccc'</span><span class="token punctuation">)</span>
<span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./eee'</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// ccc.js</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;ccc&quot;</span><span class="token punctuation">)</span>
<span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;./ddd&quot;</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// ddd.js</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;ddd&quot;</span><span class="token punctuation">)</span>
<span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;./eee&quot;</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// eee.js</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;eee&quot;</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// main.js</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;main&quot;</span><span class="token punctuation">)</span>

<span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./aaa'</span><span class="token punctuation">)</span>
<span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./bbb'</span><span class="token punctuation">)</span>

<span class="token comment">/**
main
aaa
ccc
ddd
eee
bbb
 */</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h3 id="commonjs规范缺点"><a href="#commonjs规范缺点" class="header-anchor">#</a> CommonJS规范缺点</h3> <p>CommonJS加载模块是同步的：</p> <ul><li>同步的意味着只有 <strong>等到对应的模块加载完毕，当前模块中的内容才能被运行</strong></li> <li>这个在服务器不会有什么问题，因为服务器 <strong>加载的js文件都是本地文件</strong> ，加载速度非常快</li></ul> <p>如果将它应用于浏览器呢？</p> <ul><li>浏览器 <strong>加载js文件需要先从服务器将文件下载下来</strong> ，之后 <strong>再加载运行</strong> ；</li> <li>那么采用 <strong>同步的就意味着后续的js代码都无法正常运行</strong> ，即使是 <strong>一些简单的DOM操作</strong> ；</li></ul> <p>所以在浏览器中，我们通常不使用CommonJS规范：</p> <ul><li>当然在webpack中使用CommonJS是另外一回事</li> <li>因为它会将我们的代码转成浏览器可以直接执行的代码</li></ul> <p>早期为了可以 <strong>在浏览器中使用模块化，通常会采用AMD或CMD</strong> ：</p> <ul><li>但是目前一方面现代的浏览器 <strong>已经支持ES Modules</strong> ，另一方面借助于webpack等工具可以 <strong>实现对CommonJS或者ES Module代码</strong> 的转换；</li> <li><strong>AMD和CMD已经使用非常少了</strong> ，所以这里我们进行简单的演练；</li></ul> <h2 id="amd规范"><a href="#amd规范" class="header-anchor">#</a> AMD规范</h2> <p>了解即可</p> <p>AMD主要是应用于浏览器的一种模块化规范：</p> <ul><li>AMD是Asynchronous Module Definition(异步模块定义)的缩写；</li> <li>它采用的是 <strong>异步加载模块</strong> ；</li> <li>事实上AMD规范还要早于CommonJS，但是CommonJS目前依然在被使用，而AMD使用得较少了；</li></ul> <p><strong>规范只是定义代码应该如何去编写</strong> ，只有有了具体的实现才能被应用：</p> <ul><li>AMD实现的比较常用的库是 <strong>require.js和curl.js</strong></li></ul> <h2 id="cmd规范"><a href="#cmd规范" class="header-anchor">#</a> CMD规范</h2> <p>了解即可</p> <p>CMD规范也是应用于浏览器的一种模块化规范：</p> <ul><li>CMD是Common Module Definition(通用模块定义)的缩写；</li> <li>它也采用了异步加载模块，但是它将CommonJS的优点吸收了过来；</li> <li>目前CMD使用也非常少了</li></ul> <p>CMD也有自己比较优秀的实现方案：</p> <ul><li>SeaJS</li></ul> <h2 id="esmodule"><a href="#esmodule" class="header-anchor">#</a> ESModule</h2> <p>在之前，JavaScript没有模块化一直是它的痛点，所以才会产生我们前面学习的社区规范：CommonJS、AMD、CMD等，所以在ES推出自己的模块化系统时，大家也是兴奋异常。</p> <p>ES Module和CommonJS的模块化有一些不同之处：</p> <ul><li>一方面它使用了import和export关键字</li> <li>另一方面它采用编译期的静态分析，并且也加入了动态引用的方式</li></ul> <p>ES Module模块采用export和import关键字来实现模块化：</p> <ul><li>export负责将模块内的内容导出</li> <li>import负责从其他模块导入内容</li></ul> <p>了解：采用ES Module将自动采用严格模式： <strong>use strict</strong></p> <h3 id="结构组件"><a href="#结构组件" class="header-anchor">#</a> 结构组件</h3> <p>在浏览器中演示ES6的模块化开发：</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token comment">&lt;!-- html --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>main.js<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>module<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>如果你的浏览器报错，可以点击下方链接查看</p> <p><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Guide/Modules" target="_blank" rel="noopener noreferrer"> Modules|MDN<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>你需要注意本地测试 — 如果你通过本地加载HTML文件(比如一个 file:// 路径的文件)，你将会遇到 CORS 错误，因为 JavaScript 模块安全性需要。</p> <p>你需要通过一个服务器来测试。</p> <p>使用VSCode的话，VSCode中有一个插件：Live Server，使用后能建一个临时的本地服务器 127.0.0.1:5500 运行代码。</p> <p>使用Webstorm的话，每次打开html文件都会默认创建一个临时的本地服务器运行代码。</p> <h3 id="export关键字"><a href="#export关键字" class="header-anchor">#</a> export关键字</h3> <p>export关键字将一个模块中的变量、函数、类等导出</p> <p>我们希望将内容导出，它可以有如下的方式：</p> <p>方式一：在语句声明的前面直接加上export关键字</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// foo.js</span>
<span class="token comment">// 第一种导出方式</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> name <span class="token operator">=</span><span class="token string">&quot;zzwi&quot;</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> age <span class="token operator">=</span> <span class="token number">18</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token parameter">num1<span class="token punctuation">,</span> num2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> num1 <span class="token operator">+</span> num2
<span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">Person</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>方式二：将所有需要导出的标识符，放到export后面的{}中</p> <ul><li>注意：这里的{}里面不是ES6的对象字面量的增强写法，{}也不是表示一个对象的；</li> <li>所以，export{name: name} 是错误的写法</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// foo.js</span>
<span class="token comment">// 第二种导出方式</span>
<span class="token keyword">const</span> name <span class="token operator">=</span> <span class="token string">&quot;zzwi&quot;</span>
<span class="token keyword">const</span> age <span class="token operator">=</span> <span class="token number">18</span>
<span class="token keyword">function</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token parameter">num1<span class="token punctuation">,</span> num2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> num1 <span class="token operator">+</span> num2
<span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token punctuation">{</span>
  name<span class="token punctuation">,</span>
  age<span class="token punctuation">,</span>
  sum
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>方式三：导出时给标识符起一个别名</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// foo.js</span>
<span class="token comment">// 第三种导出方式</span>
<span class="token keyword">const</span> name <span class="token operator">=</span> <span class="token string">&quot;zzwi&quot;</span>
<span class="token keyword">const</span> age <span class="token operator">=</span> <span class="token number">18</span>
<span class="token keyword">function</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token parameter">num1<span class="token punctuation">,</span> num2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> num1 <span class="token operator">+</span> num2
<span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token punctuation">{</span>
  name <span class="token keyword">as</span> fName<span class="token punctuation">,</span>
  age <span class="token keyword">as</span> fAge<span class="token punctuation">,</span>
  sum <span class="token keyword">as</span> fSum
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h3 id="import关键字"><a href="#import关键字" class="header-anchor">#</a> import关键字</h3> <p>import关键字负责从另外一个模块中导入内容</p> <p>导入内容的方式也有多种：</p> <p>方式一：import {标识符列表} from '模块' ；</p> <ul><li>注意：这里的{}也不是一个对象，里面只是存放导入的标识符列表内容；</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// main.js</span>
<span class="token comment">// 第一种导入方式</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> name<span class="token punctuation">,</span> age<span class="token punctuation">,</span> sum <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./foo.js'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>方式二：导入时给标识符起别名</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// main.js</span>
<span class="token comment">// 第二种导入方式</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> name <span class="token keyword">as</span> fName<span class="token punctuation">,</span> age <span class="token keyword">as</span> fAge<span class="token punctuation">,</span> sum <span class="token keyword">as</span> fSum <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./foo.js'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>方式三：通过 * 将模块功能放到一个模块功能对象(a module object)上</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// main.js</span>
<span class="token comment">// 第三种导入方式</span>
<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> foo <span class="token keyword">from</span> <span class="token string">'./foo.js'</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>foo<span class="token punctuation">.</span>name<span class="token punctuation">)</span> <span class="token comment">// zzwi</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>foo<span class="token punctuation">.</span>age<span class="token punctuation">)</span> <span class="token comment">// 18</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>foo<span class="token punctuation">.</span><span class="token function">sum</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 30</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="export和import"><a href="#export和import" class="header-anchor">#</a> export和import</h3> <p>补充： <strong>export和import可以结合使用</strong></p> <p>第一种方式：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// main.js</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> sum <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./foo.js'</span>
<span class="token keyword">export</span> <span class="token punctuation">{</span>
  sum
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>第二种方式：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// main.js</span>
<span class="token keyword">export</span> <span class="token punctuation">{</span> sum <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./foo.js'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>第三种方式：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// main.js</span>
<span class="token keyword">export</span> <span class="token operator">*</span> <span class="token keyword">from</span> <span class="token string">'./foo.js'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>为什么要这样做呢？</p> <ul><li>在开发和封装一个功能库时，通常我们希望将暴露的所有接口放到一个文件中；</li> <li>这样方便指定统一的接口规范，也方便阅读；</li> <li>这个时候，我们就可以把export和import结合使用</li></ul> <h3 id="default用法"><a href="#default用法" class="header-anchor">#</a> default用法</h3> <p>前面我们学习的导出功能都是有名字的导出(named exports):</p> <ul><li>在导出export时指定了名字</li> <li>在导入import时需要知道具体的名字</li></ul> <p>还有一种导出叫做默认导出(default export)</p> <ul><li>默认导出export时可以不需要指定名字；</li> <li>在导入时不需要使用{}, 并且可以自己来指定名字；</li> <li>它也方便我们和现有的CommonJS等规范相互操作；</li></ul> <p>注意：在一个模块中，只能有一个默认导出(default export)</p> <p>第一种默认导出方式</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// foo.js</span>
<span class="token comment">// 第一种默认导出</span>
<span class="token keyword">const</span> name <span class="token operator">=</span> <span class="token string">&quot;zzwi&quot;</span>
<span class="token keyword">const</span> age <span class="token operator">=</span> <span class="token number">18</span>
<span class="token keyword">function</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token parameter">num1<span class="token punctuation">,</span> num2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> num1 <span class="token operator">+</span> num2
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token punctuation">{</span>
  name<span class="token punctuation">,</span>
  age<span class="token punctuation">,</span>
  sum <span class="token keyword">as</span> <span class="token keyword">default</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>第二种默认导出方式</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// foo.js</span>
<span class="token comment">// 第二种默认导出</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> sum
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="import函数"><a href="#import函数" class="header-anchor">#</a> import函数</h3> <p>import函数的使用：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// main.js</span>
<span class="token comment">// import函数</span>
<span class="token comment">// import函数返回的结果是一个Promise</span>
<span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'./foo.js'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>name<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;后续的代码~&quot;</span><span class="token punctuation">)</span>
<span class="token comment">/**
后续的代码~
zzwi
 */</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>通过import加载一个模块，是不可以将其放到逻辑代码中的，比如：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// main.js</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">import</span> sum <span class="token keyword">from</span> <span class="token string">'./foo.js'</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>为什么会出现这个情况呢？</p> <ul><li>这是因为ES Module在被JS引擎解析时，就必须知道它的依赖关系</li> <li>由于这个时候js代码没有任何的运行，所以无法再进行类似于if判断中代码的执行</li> <li>甚至下面的这种写法也是错误的：因为我们必须等到代码运行时才能确定path的值</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// main.js</span>
<span class="token keyword">let</span> flag <span class="token operator">=</span> <span class="token boolean">true</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>flag<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'./foo.js'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">aaa</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    aaa<span class="token punctuation">.</span><span class="token function">aaa</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="import-meta"><a href="#import-meta" class="header-anchor">#</a> import meta</h3> <p>import.meta是一个给JavaScript暴露特定上下文的元数据属性的对象。</p> <ul><li>它包含了这个模块的信息，比如说这个模块的URL；</li> <li>在ES11(ES2020)中新增的特性；</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// main.js</span>
<span class="token comment">// ES11新增的属性</span>
<span class="token comment">// meta属性本身也是一个对象：{url: 当前模块所在的路径}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">import</span><span class="token punctuation">.</span>meta<span class="token punctuation">)</span> <span class="token comment">// {url: ...}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="内部原理"><a href="#内部原理" class="header-anchor">#</a> 内部原理</h3> <p>ES Module的解析流程</p> <p>ES Module是如何被浏览器解析并且让模块之间可以相互引用的呢？</p> <p><a href="https://hacks.mozilla.org/2018/03/es-modules-a-cartoon-deep-dive/" target="_blank" rel="noopener noreferrer">点击查看文章<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>静态分析：只解析导入和导出语句，其他代码不执行，包括赋值语句和条件判断语句等，如下代码便不会执行导致import语句也无法解析</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">let</span> flag <span class="token operator">=</span> <span class="token boolean">false</span>
flag <span class="token operator">=</span> <span class="token boolean">true</span>
<span class="token keyword">if</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">import</span> <span class="token punctuation">{</span>foo<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./foo.js'</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>ES Module的解析过程可以划分为三个阶段：</p> <ul><li>阶段一：构建(Construction)，根据地址查找js文件，文件下载，将其解析成模块记录(Module Record)；</li></ul> <img src="https://s3.bmp.ovh/imgs/2022/04/08/df2040d42ede78de.png" alt="ESModule解析流程-Construction" style="zoom:75%;"> <p><img src="https://hacks.mozilla.org/files/2018/03/10_construction-768x464.png" alt="hacks-ESModule解析流程-Construction"></p> <p>创建了一个map(映射关系)来存放下载的js文件和对应的Module Record。</p> <p><img src="https://hacks.mozilla.org/files/2018/03/25_module_map-768x367.png" alt="hacks-ModuleMap"></p> <ul><li>阶段二：实例化(Instantiation)，对模块记录进行实例化，并且分配内存空间， <strong>仅解析模块的导入和导出语句</strong> ，把模块指向对应的内存地址。</li></ul> <img src="https://s3.bmp.ovh/imgs/2022/04/08/8344734ce844fc10.png" alt="ESModule解析流程-Instantiation" style="zoom:75%;"> <p><img src="https://hacks.mozilla.org/files/2018/03/30_live_bindings_02-768x316.png" alt="hacks-ESModule解析流程-Instantiation"></p> <ul><li>阶段三：运行(Evaluation), 运行代码，计算值，并且将值填充到内存地址中；</li></ul> <img src="https://s3.bmp.ovh/imgs/2022/04/08/63999d2dadf4918c.png" alt="ESModule解析流程-Evaluation" style="zoom:75%;"> <p><img src="https://hacks.mozilla.org/files/2018/03/30_live_bindings_04-768x316.png" alt="hacks-ESModule解析流程-Evaluation"></p> <p><strong>导出模块可以更新导出变量的值，但导入模块不可以更新导入变量的值</strong></p> <p>一、导出模块修改</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// foo.js</span>
<span class="token keyword">let</span> name <span class="token operator">=</span> <span class="token string">&quot;zzwi&quot;</span>
<span class="token keyword">let</span> age <span class="token operator">=</span> <span class="token number">18</span>

<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  name <span class="token operator">=</span> <span class="token string">&quot;kobe&quot;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span>

<span class="token keyword">export</span> <span class="token punctuation">{</span>
  name<span class="token punctuation">,</span>
  age
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// main.js</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> name<span class="token punctuation">,</span> age <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./foo.js'</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span> <span class="token comment">// zzwi</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>age<span class="token punctuation">)</span> <span class="token comment">// 18</span>

<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span> <span class="token comment">// kobe</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">2000</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>二、导入模块修改</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// foo.js</span>
<span class="token keyword">let</span> name <span class="token operator">=</span> <span class="token string">&quot;zzwi&quot;</span>
<span class="token keyword">let</span> age <span class="token operator">=</span> <span class="token number">18</span>

<span class="token keyword">export</span> <span class="token punctuation">{</span>
  name<span class="token punctuation">,</span>
  age
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// main.js</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> name<span class="token punctuation">,</span> age <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./foo.js'</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span> <span class="token comment">// zzwi</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>age<span class="token punctuation">)</span> <span class="token comment">// 18</span>

<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  name <span class="token operator">=</span> <span class="token string">&quot;james&quot;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span>
<span class="token comment">// main.js:7 Uncaught TypeError: Assignment to constant variable.</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>浏览器报错。</p> <h2 id="参考"><a href="#参考" class="header-anchor">#</a> 参考</h2> <p><a href="https://ke.qq.com/course/3619571" target="_blank" rel="noopener noreferrer">深入JavaScript高级语法-coderwhy<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></div></div> <div class="page-slot page-slot-bottom"><!-- 横向自适应 -->
      <ins class="adsbygoogle"
          style="display:block"
          data-ad-client="ca-pub-7828333725993554"
          data-ad-slot="6620245489"
          data-ad-format="auto"
          data-full-width-responsive="true"></ins>
      <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
      </script></div> <div class="page-edit"><div class="edit-link"><a href="https://github.com/zzwi/edit/master/docs/JavaScript笔记/20.JS高级/24.JavaScript模块化.md" target="_blank" rel="noopener noreferrer">编辑</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="tags"><a href="/tags/?tag=JavaScript" title="标签">#JavaScript</a></div> <!----></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/pages/a4ec2b/" class="page-nav-centre page-nav-centre-prev"><div class="tooltip">异常处理</div></a> <a href="/pages/773e34/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">JavaScript错题集(part1)</div></a></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/pages/a4ec2b/" class="prev">异常处理</a></span> <span class="next"><a href="/pages/773e34/">JavaScript错题集(part1)</a>→
      </span></p></div></div></div> <div class="article-list"><div class="article-title"><a href="/archives/" class="iconfont icon-bi">最近更新</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/pages/773e34/"><div>JavaScript错题集(part1)</div></a> <span>04-07</span></dt></dl><dl><dd>02</dd> <dt><a href="/pages/a4ec2b/"><div>异常处理</div></a> <span>04-04</span></dt></dl><dl><dd>03</dd> <dt><a href="/pages/6147c6/"><div>async-await</div></a> <span>04-01</span></dt></dl> <dl><dd></dd> <dt><a href="/archives/" class="more">更多文章&gt;</a></dt></dl></div></div></main></div> <div class="footer"><div class="icons"><a href="mailto:2065210282@qq.com" title="发邮件" target="_blank" class="iconfont icon-youjian"></a><a href="https://github.com/zzwi" title="GitHub" target="_blank" class="iconfont icon-github"></a><a href="https://music.163.com/#/playlist?id=755597173" title="听音乐" target="_blank" class="iconfont icon-erji"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
    | Copyright © 2021-2022
    <span>Zzwi | Powered by <a href="https://webify.cloudbase.net/" target="_blank">CloudBase Webify</a></span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <!----> <!----> <div class="custom-html-window custom-html-window-rb" style="display:;"><div class="custom-wrapper"><i class="close-but">×</i> <div><!-- 固定160*160px -->
      <ins class="adsbygoogle"
          style="display:inline-block;max-width:160px;max-height:160px"
          data-ad-client="ca-pub-7828333725993554"
          data-ad-slot="8377369658"></ins>
      <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
      </script>
      </div></div></div></div><div class="global-ui"><div></div></div></div>
    <script src="/assets/js/app.440246d8.js" defer></script><script src="/assets/js/2.4c3fdaa0.js" defer></script><script src="/assets/js/56.1c1815b6.js" defer></script>
  </body>
</html>