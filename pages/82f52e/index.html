<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Webpack5(part2) | Zzwi&#39;s blog</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/img/favicon.ico">
    <script data-ad-client="ca-pub-7828333725993554" async="async" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <meta name="description" content="Zzwi的web前端技术博客,简洁至上,专注web前端学习与总结。JavaScript,js,ES6,TypeScript,vue,python,css3,html5,Node,git,github等技术文章。">
    <meta name="keywords" content="前端博客,个人技术博客,前端,前端开发,前端框架,web前端,前端面试题,技术文档,学习,面试,JavaScript,js,ES6,TypeScript,vue,python,css3,html5,Node,git,github,markdown">
    <meta name="baidu-site-verification" content="7F55weZDDc">
    <meta name="theme-color" content="#11a8cd">
    <link rel="preload" href="/assets/css/0.styles.546f0649.css" as="style"><link rel="preload" href="/assets/js/app.71e14a09.js" as="script"><link rel="preload" href="/assets/js/2.4c3fdaa0.js" as="script"><link rel="preload" href="/assets/js/78.61acab51.js" as="script"><link rel="prefetch" href="/assets/js/10.07cd4bc0.js"><link rel="prefetch" href="/assets/js/11.f73f4e15.js"><link rel="prefetch" href="/assets/js/12.73d1105b.js"><link rel="prefetch" href="/assets/js/13.04284b19.js"><link rel="prefetch" href="/assets/js/14.13ee3349.js"><link rel="prefetch" href="/assets/js/15.41f743aa.js"><link rel="prefetch" href="/assets/js/16.1685fe06.js"><link rel="prefetch" href="/assets/js/17.6f5fc7cb.js"><link rel="prefetch" href="/assets/js/18.d7447c93.js"><link rel="prefetch" href="/assets/js/19.092d487e.js"><link rel="prefetch" href="/assets/js/20.9e2678b7.js"><link rel="prefetch" href="/assets/js/21.6ecb218a.js"><link rel="prefetch" href="/assets/js/22.8751c961.js"><link rel="prefetch" href="/assets/js/23.5e173aa1.js"><link rel="prefetch" href="/assets/js/24.898338fa.js"><link rel="prefetch" href="/assets/js/25.07436094.js"><link rel="prefetch" href="/assets/js/26.c0ccf9e2.js"><link rel="prefetch" href="/assets/js/27.cf3451c9.js"><link rel="prefetch" href="/assets/js/28.33d2fba7.js"><link rel="prefetch" href="/assets/js/29.19047381.js"><link rel="prefetch" href="/assets/js/3.81e49c1b.js"><link rel="prefetch" href="/assets/js/30.f060d317.js"><link rel="prefetch" href="/assets/js/31.c10d5cd9.js"><link rel="prefetch" href="/assets/js/32.08620679.js"><link rel="prefetch" href="/assets/js/33.1ec31c78.js"><link rel="prefetch" href="/assets/js/34.5b9a73d4.js"><link rel="prefetch" href="/assets/js/35.6f8bdadb.js"><link rel="prefetch" href="/assets/js/36.b9c1be30.js"><link rel="prefetch" href="/assets/js/37.b132ed57.js"><link rel="prefetch" href="/assets/js/38.34658003.js"><link rel="prefetch" href="/assets/js/39.431a596f.js"><link rel="prefetch" href="/assets/js/4.3861cf58.js"><link rel="prefetch" href="/assets/js/40.3fccc8d8.js"><link rel="prefetch" href="/assets/js/41.b4c9ae90.js"><link rel="prefetch" href="/assets/js/42.8c769098.js"><link rel="prefetch" href="/assets/js/43.00c0ecd2.js"><link rel="prefetch" href="/assets/js/44.f1c457ab.js"><link rel="prefetch" href="/assets/js/45.0dec8d70.js"><link rel="prefetch" href="/assets/js/46.94358fbc.js"><link rel="prefetch" href="/assets/js/47.19ed708e.js"><link rel="prefetch" href="/assets/js/48.481ca412.js"><link rel="prefetch" href="/assets/js/49.c8841457.js"><link rel="prefetch" href="/assets/js/5.c0076e14.js"><link rel="prefetch" href="/assets/js/50.7c76b4af.js"><link rel="prefetch" href="/assets/js/51.1fb4370c.js"><link rel="prefetch" href="/assets/js/52.7e5ddda0.js"><link rel="prefetch" href="/assets/js/53.1fb2c540.js"><link rel="prefetch" href="/assets/js/54.6b7b6db9.js"><link rel="prefetch" href="/assets/js/55.227548cb.js"><link rel="prefetch" href="/assets/js/56.fc5817b0.js"><link rel="prefetch" href="/assets/js/57.9529bf87.js"><link rel="prefetch" href="/assets/js/58.24208b9b.js"><link rel="prefetch" href="/assets/js/59.30556c40.js"><link rel="prefetch" href="/assets/js/6.bb063f54.js"><link rel="prefetch" href="/assets/js/60.5685023c.js"><link rel="prefetch" href="/assets/js/61.ae23acc4.js"><link rel="prefetch" href="/assets/js/62.4b9651fc.js"><link rel="prefetch" href="/assets/js/63.4793d40e.js"><link rel="prefetch" href="/assets/js/64.80db0912.js"><link rel="prefetch" href="/assets/js/65.f9af4613.js"><link rel="prefetch" href="/assets/js/66.7018a23d.js"><link rel="prefetch" href="/assets/js/67.0b1aaa5e.js"><link rel="prefetch" href="/assets/js/68.dd5ded49.js"><link rel="prefetch" href="/assets/js/69.767bb060.js"><link rel="prefetch" href="/assets/js/7.590d37c9.js"><link rel="prefetch" href="/assets/js/70.92d7253b.js"><link rel="prefetch" href="/assets/js/71.ee185926.js"><link rel="prefetch" href="/assets/js/72.76bc109a.js"><link rel="prefetch" href="/assets/js/73.5e6e3237.js"><link rel="prefetch" href="/assets/js/74.0bcddd69.js"><link rel="prefetch" href="/assets/js/75.a167dd7d.js"><link rel="prefetch" href="/assets/js/76.a438fb23.js"><link rel="prefetch" href="/assets/js/77.8858251c.js"><link rel="prefetch" href="/assets/js/79.905b66e2.js"><link rel="prefetch" href="/assets/js/8.c25c287d.js"><link rel="prefetch" href="/assets/js/80.89111c79.js"><link rel="prefetch" href="/assets/js/81.2ede7c9c.js"><link rel="prefetch" href="/assets/js/82.cf449b23.js"><link rel="prefetch" href="/assets/js/83.cb4ca525.js"><link rel="prefetch" href="/assets/js/84.d8fb2fb6.js"><link rel="prefetch" href="/assets/js/85.7bffec5d.js"><link rel="prefetch" href="/assets/js/86.825100fe.js"><link rel="prefetch" href="/assets/js/87.6046af3c.js"><link rel="prefetch" href="/assets/js/9.52009cf9.js">
    <link rel="stylesheet" href="/assets/css/0.styles.546f0649.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/zzwi-logo.jpg" alt="Zzwi's blog" class="logo"> <span class="site-name can-hide">Zzwi's blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><a href="/web/" class="link-title">前端</a> <span class="title" style="display:none;">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>学习笔记</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/note/css/" class="nav-link">CSS</a></li><li class="dropdown-subitem"><a href="/note/javascript/" class="nav-link">JavaScript</a></li><li class="dropdown-subitem"><a href="/note/vue/" class="nav-link">Vue</a></li></ul></li><li class="dropdown-item"><h4>踩坑记录</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/record/html/" class="nav-link">HTML的踩坑之路</a></li><li class="dropdown-subitem"><a href="/record/vue/" class="nav-link">Vue的踩坑之路</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="更多" class="dropdown-title"><a href="/more/" class="link-title">更多</a> <span class="title" style="display:none;">更多</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/friends/" class="nav-link">友情链接</a></li></ul></div></div><div class="nav-item"><a href="/about/" class="nav-link">关于</a></div><div class="nav-item"><a href="/pages/beb6c0bd8a66cea6/" class="nav-link">收藏</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">归档</a></li></ul></div></div> <a href="https://github.com/zzwi" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="https://cdn.jsdelivr.net/gh/zzwi/mycdn/source/images/avatar.png"> <div class="blogger-info"><h3>Zzwi</h3> <span>前端小白</span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><a href="/web/" class="link-title">前端</a> <span class="title" style="display:none;">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>学习笔记</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/note/css/" class="nav-link">CSS</a></li><li class="dropdown-subitem"><a href="/note/javascript/" class="nav-link">JavaScript</a></li><li class="dropdown-subitem"><a href="/note/vue/" class="nav-link">Vue</a></li></ul></li><li class="dropdown-item"><h4>踩坑记录</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/record/html/" class="nav-link">HTML的踩坑之路</a></li><li class="dropdown-subitem"><a href="/record/vue/" class="nav-link">Vue的踩坑之路</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="更多" class="dropdown-title"><a href="/more/" class="link-title">更多</a> <span class="title" style="display:none;">更多</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/friends/" class="nav-link">友情链接</a></li></ul></div></div><div class="nav-item"><a href="/about/" class="nav-link">关于</a></div><div class="nav-item"><a href="/pages/beb6c0bd8a66cea6/" class="nav-link">收藏</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">归档</a></li></ul></div></div> <a href="https://github.com/zzwi" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>基础</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Vue3学习</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/f3a2be/" class="sidebar-link">Webpack5(part1)</a></li><li><a href="/pages/82f52e/" aria-current="page" class="active sidebar-link">Webpack5(part2)</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/82f52e/#认识babel" class="sidebar-link">认识babel</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/82f52e/#babel的命令行使用" class="sidebar-link">babel的命令行使用</a></li><li class="sidebar-sub-header"><a href="/pages/82f52e/#babel插件的使用" class="sidebar-link">babel插件的使用</a></li><li class="sidebar-sub-header"><a href="/pages/82f52e/#babel的预设preset" class="sidebar-link">babel的预设preset</a></li><li class="sidebar-sub-header"><a href="/pages/82f52e/#babel原理" class="sidebar-link">babel原理</a></li><li class="sidebar-sub-header"><a href="/pages/82f52e/#babel-loader" class="sidebar-link">babel-loader</a></li></ul></li><li class="sidebar-sub-header"><a href="/pages/82f52e/#vue的打包" class="sidebar-link">vue的打包</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/82f52e/#vue不同版本解析" class="sidebar-link">vue不同版本解析</a></li><li class="sidebar-sub-header"><a href="/pages/82f52e/#全局标识的配置" class="sidebar-link">全局标识的配置</a></li><li class="sidebar-sub-header"><a href="/pages/82f52e/#vscode对sfc文件的支持" class="sidebar-link">VSCode对SFC文件的支持</a></li></ul></li><li class="sidebar-sub-header"><a href="/pages/82f52e/#本地服务器" class="sidebar-link">本地服务器</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/82f52e/#webpack-watch" class="sidebar-link">webpack watch</a></li><li class="sidebar-sub-header"><a href="/pages/82f52e/#webpack-dev-server" class="sidebar-link">webpack-dev-server</a></li><li class="sidebar-sub-header"><a href="/pages/82f52e/#模块热替换-hmr" class="sidebar-link">模块热替换(HMR)</a></li><li class="sidebar-sub-header"><a href="/pages/82f52e/#devserver的其他属性" class="sidebar-link">devServer的其他属性：</a></li><li class="sidebar-sub-header"><a href="/pages/82f52e/#resolve模块解析" class="sidebar-link">resolve模块解析</a></li></ul></li><li class="sidebar-sub-header"><a href="/pages/82f52e/#拆分webpack-config-js" class="sidebar-link">拆分webpack.config.js</a></li><li class="sidebar-sub-header"><a href="/pages/82f52e/#参考" class="sidebar-link">参考</a></li></ul></li><li><a href="/pages/5d8eed/" class="sidebar-link">VueCLI和Vite</a></li><li><a href="/pages/72027b/" class="sidebar-link">Vue3组件化开发(part1)</a></li><li><a href="/pages/55ab04/" class="sidebar-link">Vue3组件化开发(part2)</a></li><li><a href="/pages/2861f2/" class="sidebar-link">Vue3组件化开发(part3)</a></li><li><a href="/pages/e633e5/" class="sidebar-link">Vue3-动画实现</a></li></ul></section></li></ul> <div class="sidebar-slot sidebar-slot-bottom"><!-- 正方形 -->
      <ins class="adsbygoogle"
          style="display:block"
          data-ad-client="ca-pub-7828333725993554"
          data-ad-slot="3508773082"
          data-ad-format="auto"
          data-full-width-responsive="true"></ins>
      <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
      </script></div></aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-1cd794fe><div class="articleInfo" data-v-1cd794fe><ul class="breadcrumbs" data-v-1cd794fe><li data-v-1cd794fe><a href="/" title="首页" class="iconfont icon-home router-link-active" data-v-1cd794fe></a></li> <li data-v-1cd794fe><a href="/note/vue/" title="Vue笔记-目录页" data-v-1cd794fe>Vue笔记</a></li> <li data-v-1cd794fe><a href="/note/vue//#Vue3学习" title="Vue笔记#Vue3学习" data-v-1cd794fe>Vue3学习</a></li> <!----></ul> <div class="info" data-v-1cd794fe><div title="作者" class="author iconfont icon-touxiang" data-v-1cd794fe><a href="https://github.com/zzwi" target="_blank" title="作者" class="beLink" data-v-1cd794fe>zzwi</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-1cd794fe><a href="javascript:;" data-v-1cd794fe>2022-05-08</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABKFJREFUSA3tVl1oFVcQnrMbrak3QUgkya1akpJYcrUtIqW1JvFBE9LiQ5v6JmJpolbMg32rVrhgoYK0QiMY6i9Y6EMaW5D+xFJaTYItIuK2Kr3+BJNwkxBj05sQY3b3nM6cs2dv9t7NT/vQJw/sndk5M/PNzJkzewGerP+pAmy+ON8lLzUJgA8ZYxYIYZmGYRnctDaWvJJAmTtfP1pvXsBCCPP8QFcCaRkZYACgDZFO4stNIcBCajEOlmmC9XpJ9bAGCaPaPmzPl32dvLSVu3BWCTQs0XQQ6g0DYgwLIoAZbBCdW/i+781o1VVlm/410mw4h06Y7bIPHNyWDyL4FHkX03Q8SrzNhZTZriieckWt7cL6MM85YcLpsi/7O9/iXFT6MswI0DmmpkSaJ0qLxFIm3+i1THHB3zmBH3PYx9CcykcLOeQVVa7QtdxTgQgEleX2AjHYfwA+2ddV77ruGoJUbhGDI09YSNXyMpUt5ylOzxgbUmtOp7NmbNt8v3arjTBfYELmLUV+M+nSawNNAUqpT3ClJWg5I3BLT+cGW/DXNGCa6tx1aakCGEigArTn4TDIPdrXXYKCZNrHLMCOEPvHBlLQ99s9eHB7EB6NTki73CVPQ2F5MSx/uRQixfmq7rK0wYD8w8E905bnPDfwoWs/rfv93NWN/ZfvwsLIU7A09gxECyISeGJkHAau98L97tuw7NXnoPyNF8FcYGLGKsOs0mN3OEyec9esGW/ZEl945dTP34wlR2FZVQWU1q0Cw8Tr7p+hgLLNL0FPxx/Q35mA8aEUrH6nCgwEl0tn7wUiZYJnNRh6DK4UH/k0lfyrsBKdPVv/AriGIQcEDQZ65LBAGe2Rzui9Ybjz7XUppz1/uKBbyVPGkN3ZAeC6hr0x7Nr38N5+EqkoOm17xpoqR9ohQF55ERSvr4Dkr3chNfC3DMzGJlNBElW8w9nsGQvhNGIzDkXzCg8cLK951xHsFBlTJspJNi3ZFIMF2AeDV3q8DNOB+YHi6QTrChDIWDBRi5U5f+ZMfJLu3ccrqxtdxk4SKH336LFxSmkqefwU5T8fhdSdQf9IVKD6aNiwI/hnmcAZ91isYMJIaCUCx9W098+LgruikeTqzqqxKPUwqJyCPJiyemVVZBOijDGjD38Os0jOiSPL1z3SPjXNANbiNPXAdzTfukjjuknNBbyz3nwgTd3AVFqUJ5hpHlq9MveLnWwttUfoygBmvVjuikxND3znrhsELnZk7k+OjIGxeNEkomyLVta0xxn+HZhjBc4YZ/AFjHjz9u3xRZl2BN4aq9nFwWh16IrQ1aHHEd3j1+4/dB9OtH4e29A2H1DyHQRmOSfQZ1Fy7MHBTGB6J/Djq6p3OxyO2cB+4Car7v/o3GXgfAkj23+x9ID1Teoamo/SXcbvSf2PX7Vc8DdCmE1vN9di+32P9/5YR3vLnhCVGUWBjEkr3yh4H8v9CzmsbdhzOKzsJKM90iFdaTMjRPhGVsakRvOaRidljo6H6G7j+ctrJpsP+4COhDIl0La2+FS4+5mlocBaXY5QnGZysIBYoeSsl5qQzrSj/cgNrfuEzlWBfwA+EjrZyWUvpAAAAABJRU5ErkJggg==">
          Webpack5(part2)
        </h1> <div class="page-slot page-slot-top"><!-- 固定100% * 90px可显示，max-height:90px未见显示-->
     <ins class="adsbygoogle"
          style="display:inline-block;width:100%;max-height:90px"
          data-ad-client="ca-pub-7828333725993554"
          data-ad-slot="6625304284"></ins>
      <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
      </script></div> <div class="theme-vdoing-content content__default"><h1 id="webpack5-part2"><a href="#webpack5-part2" class="header-anchor">#</a> Webpack5(part2)</h1> <p>版本号：</p> <blockquote><p>webpack: 5.72.0
webpack-cli: 4.9.2
webpack-dev-server 4.9.0</p></blockquote> <h2 id="认识babel"><a href="#认识babel" class="header-anchor">#</a> 认识babel</h2> <p>虽然在开发中我们很少直接去接触babel，但是babel对于前段开发来说，目前是不可缺少的一部分：</p> <ul><li>在开发中，我们想要使用 <strong>ES6+的语法</strong> ，想要使用 <strong>TypeScript</strong> ，开发 <strong>React</strong> 项目，它们都是离不开Babel的；</li> <li>所以，学习Babel对于我们理解代码从编写到线上的转变过程至关重要；</li></ul> <p>那么，Babel是什么？</p> <ul><li>Babel是一个 <strong>工具链</strong> ，主要用于旧浏览器或者环境中将 ES6+ 代码转换为向后兼容版本的JavaScript；</li> <li>包括：语法转换、源代码转换等；</li></ul> <h3 id="babel的命令行使用"><a href="#babel的命令行使用" class="header-anchor">#</a> babel的命令行使用</h3> <p>babel本身可以作为一个独立的工具(和postcss一样)，不和webpack等构建工具配置来单独使用。</p> <p>如果想在命令行直接使用babel，需要安装下面这两个库：</p> <ul><li><strong>babel/core :</strong> babel的核心代码，必须安装；</li> <li><strong>babel/cli :</strong> 可以让我们在命令行使用babel(与webpack配置时不必安装)；</li></ul> <blockquote><p>npm install @babel/core @babel/cli -D</p></blockquote> <p>使用babel来处理我们的源代码：</p> <ul><li>src : 是源文件的目录；</li> <li>--out-dir : 指定要输出的文件夹dist；</li></ul> <blockquote><p>npx babel src --out-dir dist</p></blockquote> <ul><li>--out-file : 指定要输出的文件；</li></ul> <blockquote><p>npx babel src --out-file dist/demo.js</p></blockquote> <p>编写一个 <strong>test.js文件</strong> 进行简单测试：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// test.js</span>
<span class="token keyword">const</span> name <span class="token operator">=</span> <span class="token string">&quot;zzwi&quot;</span>
<span class="token keyword">const</span> nums <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span>

nums<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>执行命令：</p> <blockquote><p>npx babel src/test.js --out-file dist/demo.js</p></blockquote> <p>成功执行后，可以看到生成了一个dist文件夹，里面有一份demo.js文件：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// demo.js</span>
<span class="token keyword">const</span> name <span class="token operator">=</span> <span class="token string">&quot;zzwi&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> nums <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
nums<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>可以看到，test.js中的ES6语法并没有在demo.js中被转换为ES5。</p> <p>这是为什么？</p> <p>因为要实现转换还得使用对应的插件。</p> <h3 id="babel插件的使用"><a href="#babel插件的使用" class="header-anchor">#</a> babel插件的使用</h3> <p>比如我们需要转换箭头函数，那么我们就可以使用 <strong>箭头函数转换相关的插件</strong> ：</p> <p>下载安装：</p> <blockquote><p>npm install @babel/plugin-transform-arrow-functions -D</p></blockquote> <p>在命令行使用：</p> <blockquote><p>npx babel src --out-dir dist --plugins=@babel/plugin-transform-arrow-functions</p></blockquote> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// demo.js</span>
<span class="token keyword">const</span> name <span class="token operator">=</span> <span class="token string">&quot;zzwi&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> nums <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
nums<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>查看转换后的结果：我们会发现箭头函数确实被转换为了普通函数，但是 <code>const</code> 并没有转成 <code>var</code> 。</p> <p>这是因为 plugin-transform-arrow-functions ，并没有提供这样的功能；</p> <p>我们需要使用 <strong>作用域转换相关的插件</strong> 来完成这样的功能：</p> <p>下载安装：</p> <blockquote><p>npm install @babel/plugin-transform-block-scoping -D</p></blockquote> <p>在命令行使用：</p> <blockquote><p>npx babel src --out-dir dist --plugins=@babel/plugin-transform-block-scoping,@babel/plugin-transform-arrow-functions</p></blockquote> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// demo.js</span>
<span class="token keyword">var</span> name <span class="token operator">=</span> <span class="token string">&quot;zzwi&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> nums <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
nums<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>从上述代码中可以看到，这次的 <code>const</code> 关键字成功转换为了 <code>var</code> , 箭头函数也一样转为了普通函数。</p> <h3 id="babel的预设preset"><a href="#babel的预设preset" class="header-anchor">#</a> babel的预设preset</h3> <p><strong>但是</strong> ，在实际的项目开发中，通常我们需要转换的内容是比较多的，如果在命令行中一个个设置，会十分麻烦，这个时候我们就可以使用预设(preset) :</p> <ul><li>preset就是将我们常用的转换插件集合在一起的工具；</li></ul> <p>下载安装：</p> <blockquote><p>npm install @babel/preset-env -D</p></blockquote> <p>执行命令：</p> <blockquote><p>npx babel src --out-dir dist --presets=@babel/preset-env</p></blockquote> <p>下面进行简单测试，使用前面编写的test.js，对其进行转换：</p> <blockquote><p>npx babel src/test.js --out-file dist/demo.js --presets=@babel/preset-env</p></blockquote> <p>结果：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// demo.js</span>
<span class="token string">&quot;use strict&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> name <span class="token operator">=</span> <span class="token string">&quot;zzwi&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> nums <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
nums<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>成功将test.js中的ES6语法都转为了ES5。</p> <h3 id="babel原理"><a href="#babel原理" class="header-anchor">#</a> babel原理</h3> <p>babel是如何做到将我们的一段代码(ES6、TypeScript、React)转成另外一段代码(ES5)的呢？</p> <ul><li>从一种 <strong>源代码(原生语言)</strong> 转换成 <strong>另一种源代码(目标语言)</strong> ，这是编译器的工作；</li> <li>我们可以将babel看成是一个编译器；</li> <li>babel编译器的作用就是将我们的 <strong>ES6+源代码</strong> ，转换成所有浏览器都可以直接识别的 <strong>ES5源代码</strong> ；</li></ul> <p>Babel也拥有编译器的工作流程：</p> <ul><li>解析阶段(Parsing)</li> <li>转换阶段(Transformation)</li> <li>生成阶段(Code Generation)</li></ul> <p><strong>注意：</strong> 下方链接是一个优秀的GitHub开源项目---使用JavaScript写的编译器，coderwhy老师跟着写过一遍。是babel官网推荐阅读的项目之一。</p> <p><a href="https://github.com/jamiebuilds/the-super-tiny-compiler" target="_blank" rel="noopener noreferrer">the-super-tiny-compiler<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>简单的编译流程图：</p> <div class="language-flow line-numbers-mode"><pre class="language-flow"><code>st<span class="token operator">=&gt;</span>start<span class="token operator">:</span> 原生源代码
la<span class="token operator">=&gt;</span>operation<span class="token operator">:</span> <span class="token function">词法分析</span><span class="token punctuation">(</span>Lexical Analysis<span class="token punctuation">)</span>
tk<span class="token operator">=&gt;</span>operation<span class="token operator">:</span> tokens数组
sa<span class="token operator">=&gt;</span>operation<span class="token operator">:</span> <span class="token function">语法分析</span><span class="token punctuation">(</span>syntactic analysis<span class="token punctuation">)</span>
ast<span class="token operator">=&gt;</span>operation<span class="token operator">:</span> <span class="token constant">AST</span>抽象语法树
tl<span class="token operator">=&gt;</span>operation<span class="token operator">:</span> <span class="token function">遍历</span><span class="token punctuation">(</span>Traversal<span class="token punctuation">)</span>
vi<span class="token operator">=&gt;</span>operation<span class="token operator">:</span> <span class="token function">访问</span><span class="token punctuation">(</span>Visitor<span class="token punctuation">)</span>
pl<span class="token operator">=&gt;</span>operation<span class="token operator">:</span> <span class="token function">应用插件</span><span class="token punctuation">(</span>Plugin<span class="token punctuation">)</span>
nast<span class="token operator">=&gt;</span>operation<span class="token operator">:</span> 新的<span class="token constant">AST</span>抽象语法树
e<span class="token operator">=&gt;</span>end<span class="token operator">:</span> 目标源代码

st<span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">la</span><span class="token punctuation">(</span>right<span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span>tk<span class="token operator">-</span><span class="token operator">&gt;</span>sa<span class="token operator">-</span><span class="token operator">&gt;</span>ast<span class="token operator">-</span><span class="token operator">&gt;</span>tl<span class="token operator">-</span><span class="token operator">&gt;</span>vi<span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">pl</span><span class="token punctuation">(</span>right<span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span>nast<span class="token operator">-</span><span class="token operator">&gt;</span>e
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h3 id="babel-loader"><a href="#babel-loader" class="header-anchor">#</a> babel-loader</h3> <p>在实际开发中，我们通常会在构建工具中通过配置babel来对其进行使用，比如在webpack中进行配置。</p> <p>下载安装：</p> <blockquote><p>npm install babel-loader @babel/core</p></blockquote> <p>与前面part1里面记录的loader使用方法一样，我们可以在webpack配置文件中设置规则来使用babel-loader, 当然，babel进行转换需要使用对应的插件，使用babel-loader也一样，需要在配置里加上对应的插件或是preset。</p> <p>下面是三种不同的配置方式：</p> <p><strong>方式一：配置plugin</strong></p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// webpack.config.js</span>
module<span class="token operator">:</span> <span class="token punctuation">{</span>
  rules<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.js$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
      use<span class="token operator">:</span> <span class="token punctuation">{</span>
        loader<span class="token operator">:</span> <span class="token string">&quot;babel-loader&quot;</span><span class="token punctuation">,</span>
        <span class="token comment">// 给loader添加参数</span>
        options<span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token comment">// 配置插件</span>
          plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token string">&quot;@babel/plugin-transform-arrow-functions&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;@babel/plugin-transform-block-scoping&quot;</span>
          <span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p><strong>方式二：配置preset(预设)</strong></p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// webpack.config.js</span>
module<span class="token operator">:</span> <span class="token punctuation">{</span>
  rules<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.js$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
      use<span class="token operator">:</span> <span class="token punctuation">{</span>
        loader<span class="token operator">:</span> <span class="token string">&quot;babel-loader&quot;</span><span class="token punctuation">,</span>
        <span class="token comment">// 给loader添加参数</span>
        options<span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token comment">// 配置preset</span>
          presets<span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token string">&quot;@babel/preset-env&quot;</span>
          <span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>如果想给preset额外传递一些参数的话，可以编写如下代码：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>preset<span class="token operator">:</span> <span class="token punctuation">[</span>
  <span class="token punctuation">[</span><span class="token string">&quot;@babel/preset-env&quot;</span><span class="token punctuation">,</span><span class="token punctuation">{</span>
    <span class="token operator">...</span><span class="token operator">...</span> <span class="token comment">// 参数</span>
  <span class="token punctuation">}</span><span class="token punctuation">]</span>
<span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p><strong>方式三：设置单独的babel配置文件</strong></p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// babel.config.js</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  presets<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token string">&quot;@babel/preset-env&quot;</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// webpack.config.js</span>
module<span class="token operator">:</span> <span class="token punctuation">{</span>
  rules<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.js$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
      loader<span class="token operator">:</span> <span class="token string">&quot;babel-loader&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p><strong>关于babel配置文件：</strong></p> <p>如上代码所示，与webpack一样，我们可以将babel的配置信息放到一个独立的文件中，babel给我们提供了两种配置文件的编写：</p> <ul><li>babel.config.js(或者.json, .cjs, .mjs)文件；</li> <li>.babelrc.js(或者.babelrc, .json, .cjs, .mjs)文件；</li></ul> <p>它们两个有什么区别呢？目前很多的项目都采用了多包管理的方式(babel本身、element-plus、umi等)；</p> <ul><li>.babelrc.js : 早期使用较多的配置方式，但是对于配置Monorepos项目是比较麻烦的；</li> <li>babel.config.js(babel7) : 可以直接作用于Monorepos项目的子包，更加推荐；</li></ul> <p><a href="https://blog.csdn.net/QcloudCommunity/article/details/122994881" target="_blank" rel="noopener noreferrer">Monorepo——探秘源码管理新姿势！<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="vue的打包"><a href="#vue的打包" class="header-anchor">#</a> vue的打包</h2> <p>首先，下载安装vue3：</p> <blockquote><p>npm install vue@next</p></blockquote> <p>不需要加 <code>-D</code> ，生产环境也会使用。</p> <p>在入口文件 <code>src/index.js</code> 内编写如下代码：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// index.js</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> createApp <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">createApp</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  template<span class="token operator">:</span> <span class="token string">&quot;#my-app&quot;</span><span class="token punctuation">,</span>
  <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      title<span class="token operator">:</span> <span class="token string">&quot;webpack_vue&quot;</span><span class="token punctuation">,</span>
      message<span class="token operator">:</span> <span class="token string">&quot;my vue3_test&quot;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

app<span class="token punctuation">.</span><span class="token function">mount</span><span class="token punctuation">(</span><span class="token string">&quot;#app&quot;</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token comment">&lt;!-- index.html --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>app<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>my-app<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">&gt;</span></span>{{title}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>{{message}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>打包运行之后，界面上没有效果。</p> <p>查看浏览器的控制台，会发现如下的警告信息：</p> <blockquote><p>runtime-core.esm-bundler.js:38</p> <p><code>[Vue warn]</code> : Component provided template option  <strong>but runtime compilation is not supported in this build of Vue</strong> . Configure your bundler to alias &quot;vue&quot; to &quot;vue/dist/vue.esm-bundler.js&quot;.
at <code>&lt;App&gt;</code></p></blockquote> <p>大致意思是，引用的vue源码不支持解析 <code>&lt;template&gt;</code> 模板，并建议我们将打包工具webpack的入口文件中引用的 &quot;vue&quot; 修改为 &quot;vue/dist/vue.esm-bundler.js&quot; .</p> <h3 id="vue不同版本解析"><a href="#vue不同版本解析" class="header-anchor">#</a> vue不同版本解析</h3> <p>在项目根目录下有一个 <code>node_modules</code> 文件夹，里面存放着使用 <code>node</code> 下载安装的模块，所以在里面可以找到我们前面下载的 <code>vue</code> ，打开之后可以看到里面存放有多个版本：</p> <img src="https://s1.ax1x.com/2022/05/29/XMC041.png" style="zoom:67%;"> <p>接下来简单说明上述版本的用途：</p> <p><strong>.runtime版本 :</strong> 在文件名中，vue之后带.runtime的版本代表着它是一个 <strong>运行时版本</strong>  ，即源码中不包含编译器部分，减少了代码量，但无法解析 <code>&lt;template&gt;</code> 模板，在webpack中，引入&quot;vue&quot;默认就是采用.runtime版本，这就是出现上面浏览器控制台的警告信息的原因。</p> <p><strong>.prod版本 :</strong> 在文件名中，末尾带.prod的版本代表着它是一个 <strong>生产环境版本</strong> ，即该源码会被打包放进服务器。</p> <p><strong>vue(.runtime).global(.prod).js :</strong></p> <ul><li>通过浏览器中的 <code>&lt;script src=&quot;...&quot;&gt;</code> 直接使用；</li> <li>通过CDN引入和下载的Vue就是这个版本；</li> <li>它会暴露一个全局的Vue供我们使用；</li></ul> <p><strong>vue(.runtime).esm-browser(.prod).js :</strong></p> <ul><li>通过原生ES模块导入使用(运行在浏览器上的HTML文件通过 <code>&lt;script type=&quot;module&quot;&gt;</code> 来使用)</li></ul> <p><strong>vue(.runtime).esm-bundler.js :</strong></p> <ul><li>用于 webpack，rollup 和 parcel 等构建工具；</li> <li>构建工具中默认是vue.runtime.esm-bundler.js；</li> <li>如果我们需要解析模板template，那么需要手动指定vue.esm-bundler.js；</li></ul> <p><strong>vue.cjs(.prod).js :</strong></p> <ul><li>服务器渲染使用；</li> <li>通过require()在Node.js中使用；</li></ul> <p>在Vue的开发过程中我们有三种方式来编写DOM元素：</p> <ul><li>方式一： <strong>template模板</strong> 的方式(上面使用的方式)；</li> <li>方式二： <strong>render函数</strong> 的方式，使用h函数来编写渲染的内容；</li> <li>方式三：通过 <strong>.vue文件</strong> 中的template来编写模板；</li></ul> <p>这三种方式分别是如何处理的呢？</p> <ul><li>方式二中的h函数可以直接返回一个 <strong>虚拟节点</strong> ，也就是 <strong>Vnode</strong> 节点；</li> <li>方式一和方式三的template都需要有 <strong>特定的代码</strong> 来对其进行解析：
<ul><li>方式三.vue文件中的template可以通过 <strong>vue-loader</strong> 对其进行编译和处理；</li> <li>方式一中的template我们必须通过 <strong>源码中的一部分代码</strong> 来进行编译；</li></ul></li></ul> <p>所以，Vue在让我们选择版本的时候分为 <strong>运行时+编译器</strong> 和 <strong>仅运行时</strong> 。</p> <ul><li><strong>运行时+编译器</strong> 包含了对template模板的编译代码，更加完整，但是体积也更大一些；</li> <li><strong>仅运行时</strong> 没有包含对template版本的编译代码，相对更小一些；</li></ul> <h3 id="全局标识的配置"><a href="#全局标识的配置" class="header-anchor">#</a> 全局标识的配置</h3> <p>明白了前面那个vue警告的原因和解决办法，在浏览器控制台中还有另外一个警告：</p> <blockquote><p>Feature flags <code>__VUE_OPTIONS_API__</code> ,  <code>__VUE_PROD_DEVTOOLS__</code> are not explicitly defined. You are running the esm-bundler build of Vue, which expects these compile-time feature flags to be globally injected via the bundler config in order to get better <strong>tree-shaking</strong> in the production bundle.</p> <p>For more details, see <a href="https://link.vuejs.org/feature-flags" target="_blank" rel="noopener noreferrer">https://link.vuejs.org/feature-flags<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p></blockquote> <p>大致意思是希望用户设置 <code>__VUE_OPTIONS_API__</code> ,  <code>__VUE_PROD_DEVTOOLS__</code> 这两个配置属性，这样便可以在 production bundle 中使用更好的 tree-shaking 功能。</p> <p>点击警告中提供给我们的链接，跳转到GitHub文档，在里面我们可以找到如下说明:</p> <blockquote><h4 id="bundler-build-feature-flags"><a href="#bundler-build-feature-flags" class="header-anchor">#</a> Bundler Build Feature Flags</h4> <p>Starting with 3.0.0-rc.3, <code>esm-bundler</code> builds now exposes global feature flags that can be overwritten at compile time:</p> <ul><li><code>__VUE_OPTIONS_API__</code> (enable/disable Options API support, default: <code>true</code>)</li> <li><code>__VUE_PROD_DEVTOOLS__</code> (enable/disable devtools support in production, default: <code>false</code>)</li></ul> <p>The build will work without configuring these flags, however it is <strong>strongly recommended</strong> to properly configure them in order to get proper tree-shaking in the final bundle. To configure these flags:</p> <ul><li>webpack: use <a href="https://webpack.js.org/plugins/define-plugin/" target="_blank" rel="noopener noreferrer">DefinePlugin<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li>Rollup: use <a href="https://github.com/rollup/plugins/tree/master/packages/replace" target="_blank" rel="noopener noreferrer">@rollup/plugin-replace<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li>Vite: configured by default, but can be overwritten using the <a href="https://github.com/vitejs/vite/blob/a4133c073e640b17276b2de6e91a6857bdf382e1/src/node/config.ts#L72-L76" target="_blank" rel="noopener noreferrer"><code>define</code> option<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <p>Note: the replacement value <strong>must be boolean literals</strong> and cannot be strings, otherwise the bundler/minifier will not be able to properly evaluate the conditions.</p></blockquote> <p>这是两个特性的标识，一个代表是否支持使用vue2.x的options，另一个代表在Production模式下是否支持使用工具devtools；</p> <p>虽然他们都有默认值，但是强烈建议对他们进行手动配置。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// webpack.config.js</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> DefinePlugin <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;webpack&quot;</span><span class="token punctuation">)</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token operator">...</span><span class="token punctuation">,</span>
  plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token operator">...</span><span class="token punctuation">,</span>
    <span class="token keyword">new</span> <span class="token class-name">DefinePlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token comment">// 这里需要双引号和单引号一起</span>
      <span class="token constant">BASE_URL</span><span class="token operator">:</span> <span class="token string">&quot;'./'&quot;</span><span class="token punctuation">,</span>
      <span class="token comment">// 是否兼容vue2的options(是否下载适配vue2的代码)</span>
      __VUE_OPTIONS_API__<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      <span class="token comment">// 是否在生产环境使用测试工具devtool</span>
      __VUE_PROD_DEVTOOLS__<span class="token operator">:</span> <span class="token boolean">false</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token operator">...</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><h3 id="vscode对sfc文件的支持"><a href="#vscode对sfc文件的支持" class="header-anchor">#</a> VSCode对SFC文件的支持</h3> <p>真实开发中多数情况下我们都是使用SFC( single-file components(单文件组件) )。</p> <p>在VSCode中对SFC提供较好支持的两个插件：</p> <ul><li>插件一：Vetur</li> <li>插件二：Vue Language Features (Volar)</li></ul> <p>安装完插件后，下面开始编写.vue文件：</p> <div class="language-vue line-numbers-mode"><pre class="language-vue"><code><span class="token comment">&lt;!-- App.vue --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">&gt;</span></span>{{title}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>{{message}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">export</span> <span class="token keyword">default</span><span class="token punctuation">{</span>
  <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      title<span class="token operator">:</span> <span class="token string">&quot;webpack_vue&quot;</span><span class="token punctuation">,</span>
      message<span class="token operator">:</span> <span class="token string">&quot;my vue3_test&quot;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span> <span class="token attr-name">scoped</span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
  <span class="token selector">h2</span><span class="token punctuation">{</span>
    <span class="token property">color</span><span class="token punctuation">:</span> aquamarine<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token selector">p</span><span class="token punctuation">{</span>
    <span class="token property">color</span><span class="token punctuation">:</span> skyblue<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><p>在入口文件进行引用：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// index.js</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> createApp <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> App <span class="token keyword">from</span> <span class="token string">'./vue/App.vue'</span>

<span class="token function">createApp</span><span class="token punctuation">(</span>App<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">mount</span><span class="token punctuation">(</span><span class="token string">&quot;#app&quot;</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>由于在打包文件中新增了.vue文件，所以我们需要添加新的loader——vue-loader，对vue文件进行解析，</p> <p>下载安装：</p> <blockquote><p>npm install vue-loader@next -D</p></blockquote> <p>同时，vue-loader的使用还需要搭配一个其自身包含的插件：</p> <p><code>VueLoaderPlugin</code></p> <p>所以，添加配置如下：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// webpack.config.js</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> VueLoaderPlugin <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;vue-loader/dist/index&quot;</span><span class="token punctuation">)</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  module<span class="token operator">:</span> <span class="token punctuation">{</span>
    rules<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.vue$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        loader<span class="token operator">:</span> <span class="token string">&quot;vue-loader&quot;</span>        
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">VueLoaderPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>进行webpack打包，成功运行！</p> <p>如果你在这一步仍然出错无法打包，那可能需要添加 @vue/compiler-sfc 来对template进行解析：</p> <blockquote><p>npm install @vue/compiler-sfc -D</p></blockquote> <p>vue-loader内部会自动调用 @vue/compiler-sfc ，不需要我们再进行手动配置。</p> <p>重新打包。</p> <p>我们还可以编写其他的vue文件来作为组件使用, 尝试着写一个HelloWorld组件，代码如下：</p> <div class="language-vue line-numbers-mode"><pre class="language-vue"><code><span class="token comment">&lt;!-- HelloWorld.vue --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
    这里是vue插件——{{message}}
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      message<span class="token operator">:</span> <span class="token string">&quot;HelloWorld&quot;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span> <span class="token attr-name">scoped</span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
  <span class="token selector">div</span><span class="token punctuation">{</span>
    <span class="token property">color</span><span class="token punctuation">:</span> darkorange<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><div class="language-vue line-numbers-mode"><pre class="language-vue"><code><span class="token comment">&lt;!-- App.vue --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">&gt;</span></span>{{title}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>{{message}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>hello-wrold</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>hello-wrold</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">import</span> HelloWrold <span class="token keyword">from</span> <span class="token string">&quot;./HelloWorld.vue&quot;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span><span class="token punctuation">{</span>
  components<span class="token operator">:</span> <span class="token punctuation">{</span>
    HelloWrold
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      title<span class="token operator">:</span> <span class="token string">&quot;webpack_vue&quot;</span><span class="token punctuation">,</span>
      message<span class="token operator">:</span> <span class="token string">&quot;my vue3_test&quot;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span> <span class="token attr-name">scoped</span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
  <span class="token selector">h2</span><span class="token punctuation">{</span>
    <span class="token property">color</span><span class="token punctuation">:</span> aquamarine<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token selector">p</span><span class="token punctuation">{</span>
    <span class="token property">color</span><span class="token punctuation">:</span> skyblue<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br></div></div><h2 id="本地服务器"><a href="#本地服务器" class="header-anchor">#</a> 本地服务器</h2> <p>目前我们开发的代码，为了运行需要有两个操作：</p> <ul><li>操作一：npm run build, 编译相关的代码；</li> <li>操作二：通过live server或者直接通过浏览器，打开index.html文件，查看效果；</li></ul> <p>这个过程在开发中往往需要重复很多次，极大地影响了我们的开发效率，我们理所当然地希望，当文件发生变化时，可以自动地完成 编译 和 展示 ；</p> <p>为了完成自动编译，webpack提供了几种可选的方式：</p> <ul><li>webpack watch mode ;</li> <li>webpack-dev-server(常用) ;</li> <li>webpack-dev-middleware ;</li></ul> <h3 id="webpack-watch"><a href="#webpack-watch" class="header-anchor">#</a> webpack watch</h3> <p>webpack给我们提供了watch模式：</p> <ul><li>在该模式下，webpack依赖图中的所有文件，只要有一个发生了更新，那么代码将被重新编译；</li> <li>这样就不需要手动去重复运行 npm run build 指令了；</li></ul> <p>开启watch模式有两种方式：</p> <ul><li>方式一：在导出的配置中，添加 watch: true ;</li></ul> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// webpack.config.js</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  watch<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token operator">...</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><ul><li>方式二：在启动webpack的脚本命令中，添加 --watch 的标识；</li></ul> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token comment">// package.json</span>
<span class="token punctuation">{</span>
  <span class="token property">&quot;scripts&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
     <span class="token property">&quot;build&quot;</span><span class="token operator">:</span> <span class="token string">&quot;webpack&quot;</span><span class="token punctuation">,</span>
     <span class="token property">&quot;serve&quot;</span><span class="token operator">:</span> <span class="token string">&quot;webpack --watch&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="webpack-dev-server"><a href="#webpack-dev-server" class="header-anchor">#</a> webpack-dev-server</h3> <p>watch模式可以监听到文件的变化，但是它本身是没有自动刷新浏览器的功能的：</p> <ul><li>当然，目前我们可以在VSCode中使用live-server来完成这样的功能；</li> <li>但是，我们希望在不使用live-server的情况下，可以具备live reloading(实时重新加载)的功能；</li></ul> <p>下载安装webpack-dev-server：</p> <blockquote><p>npm install webpack-dev-server -D</p></blockquote> <p>如何使用？</p> <p>在package.json配置脚本命令：</p> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token comment">// package.json</span>
<span class="token punctuation">{</span>
  <span class="token property">&quot;scripts&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
     <span class="token property">&quot;serve&quot;</span><span class="token operator">:</span> <span class="token string">&quot;webpack serve&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>配置完成后，在命令行运行：</p> <blockquote><p>npm run serve</p></blockquote> <p>成功运行便能使用了；</p> <blockquote><p><i> [webpack-dev-server] Project is running at:
<i> [webpack-dev-server] Loopback: http://localhost:8080/</i></i></p></blockquote> <p>点击命令行给予的localhost链接，便能进行预览。</p> <p>在webpack.config.js文件中配置webpack-dev-server的devServer的contentBase属性时遭遇报错：</p> <blockquote><p>Invalid options object. Dev Server has been initialized using an options object that does not match the API schema.</p></blockquote> <p>大致意思是webpack-dev-server改用别的属性了，查了下发现新属性是 <code>static</code> , contentBase有的它都有，contentBase没有的它也有 。</p> <p>那么这旧版的 <code>contentBase</code> 和新版的 <code>static</code> 都有什么作用呢？</p> <p>下面是一个简单例子：</p> <p>对static进行配置：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// webpack.config.js</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;path&quot;</span><span class="token punctuation">)</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    devServer<span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token keyword">static</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        directory<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'./test'</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>这个配置的作用是，当程序在打包的资源里找不到需要的文件时，就让它去根目录的test文件夹下面找。</p> <p>如下：</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token comment">&lt;!-- index.html --&gt;</span>
......
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>./abc.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>当在打包资源里找不到abc.js文件时，程序就会去根目录下的test文件夹里寻找：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// ./test/abc.js</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;abcabcabc&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>然后在控制台成功打印：</p> <blockquote><p>abcabcabc</p></blockquote> <p>在前面我们使用了 <strong>CopyWebpackPlugin</strong> 插件进行了.ico图标资源的复制，这个属性的作用与之类似，不同的是，插件是在打包的时候进行资源复制，devServer的 <code>static</code> 属性是在本地服务的实时更新的开发环境中进行资源复制的。</p> <p>再追加一个配置：属性target</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// webpack.config.js</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  target<span class="token operator">:</span> <span class="token string">&quot;web&quot;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>意思很好理解，目标是在浏览器上运行，更加贴合浏览器环境，改为</p> <blockquote><p>target: &quot;node&quot;</p></blockquote> <p>则是更加契合node环境。</p> <p><strong>watch模式与webpack-dev-server的区别：</strong></p> <p>实时编译流程：</p> <ul><li>watch模式：将原文件编译打包输出到dist文件夹中，再把dist文件夹内的文件读取成 数据流 放进内存；</li> <li>dev-server：在编译之后不会写入到任何输出文件，而是直接将 数据流 保留在内存中：
<ul><li>这是因为webpack-dev-server使用了一个第三方库：memfs；</li> <li>webpack官方之前自己写了一个库：memory-fs，但已经很久没维护，不再使用了。</li></ul></li></ul> <h3 id="模块热替换-hmr"><a href="#模块热替换-hmr" class="header-anchor">#</a> 模块热替换(HMR)</h3> <p>什么是HMR呢？</p> <ul><li>HMR的全称是Hot Module Replacement，翻译为模块热替换；</li> <li>模块热替换是指在应用程序运行过程中，替换、添加、删除模块，而无需重新刷新整个页面；</li></ul> <p>HMR通过如下几种方式，来提高开发的速度：</p> <ul><li>不重新加载整个页面，这样可以保留某些应用程序的状态不丢失；</li> <li>只更新需要变化的内容，节省开发的时间；</li> <li>修改了css、js源代码，会立即在浏览器更新，相当于直接在浏览器的devtools中直接修改样式；</li></ul> <p>如何使用HMR呢？</p> <ul><li>默认情况下，webpack-dev-server已经支持HMR，我们只需要开启即可；</li> <li>在不开启HMR的情况下，当我们修改了源代码之后，整个页面会自动刷新，使用的是live reloading；</li></ul> <p><strong>开启HMR</strong></p> <p>修改配置：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// webpack.config.js</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  devServer<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span><span class="token punctuation">,</span>
    hot<span class="token operator">:</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>但测试发现，当我们修改了某一模块的代码时，依然是整个页面一起刷新：</p> <ul><li>这是因为我们需要去指定哪些模块需要热更新：</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// src/index.js(webpack入口文件)</span>
<span class="token keyword">import</span> <span class="token string">&quot;./js/element&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">if</span><span class="token punctuation">(</span>module<span class="token punctuation">.</span>hot<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  module<span class="token punctuation">.</span>hot<span class="token punctuation">.</span><span class="token function">accept</span><span class="token punctuation">(</span><span class="token string">&quot;./js/element.js&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;element模块发生更新了&quot;</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>热更新功能成功设置。</p> <p><strong>框架的HMR</strong></p> <p>有一个问题：在开发其他项目时，我们是否需要经常手动去写入 module.hot.accept 相关的API呢？</p> <ul><li>比如开发Vue、React项目，我们修改了组件，希望进行热更新，这个时候应该如何去操作呢？</li> <li>针对这些社区已经有很成熟的解决方案了；</li> <li>比如vue开发中，我们使用vue-loader，此loader支持vue组件的HMR，提供开箱即用的体验；</li> <li>比如react开发中，有React Hot Loader，实时调整react组件(目前React官方已经弃用了，改用react-refresh)；</li></ul> <p><strong>HMR的原理</strong></p> <p>webpack-dev-server会创建两个服务 :  <strong>提供静态资源的服务(express)</strong> 和 <strong>Socket服务(net.Socket)</strong> ;</p> <p>express server负责直接提供静态资源的服务(打包后的资源直接被浏览器请求和解析) ;</p> <p>HMR Socket Server, 是一个socket的长链接：</p> <ul><li>长连接有一个最好的好处是建立连接后双方可以通信(服务器可以直接发送文件到客户端)；</li> <li>当服务器监听到对应的模块发生变化时，会生成两个文件 .json(manifest文件)和 .js(update chunk)；</li> <li>通过长连接，可以直接将这两个文件主动发送给客户端(浏览器)；</li> <li>浏览器拿到两个新的文件后，通过HMR runtime机制，加载这两个文件，并且针对修改的模块进行更新；</li></ul> <h3 id="devserver的其他属性"><a href="#devserver的其他属性" class="header-anchor">#</a> devServer的其他属性：</h3> <p><strong>host</strong> 设置主机地址：</p> <ul><li>默认值是localhost；</li> <li>如果希望其他地方也可以访问，可以设置为 0.0.0.0；</li></ul> <p>localhost 和 0.0.0.0 的区别：</p> <ul><li>localhost：本质上是一个域名，通常情况下会被解析成127.0.0.1；</li> <li>127.0.0.1：回环地址(Loop Back Address)，表达的意思其实是我们主机自己发出去的包，直接被自己接收；
<ul><li>正常的数据库包经过 <strong>应用层 - 传输层 - 网络层 - 数据链路层 - 物理层</strong> ；</li> <li>而回环地址，是在网络层直接就被获取到了，是不会经过数据链路层和物理层的；</li> <li>比如我们监听 127.0.0.1 时，在同一网段下的主机中，通过ip地址是不能访问的；</li></ul></li> <li>0.0.0.0：监听IPV4上所有的地址，再根据端口找到不同的应用程序；
<ul><li>比如我们监听 0.0.0.0 时，在同一网段下的主机中，通过ip地址是可以访问的；</li> <li>不知名原因导致我将host设置为 0.0.0.0 之后网页一直打不开；</li> <li>原因找到了，如下：</li> <li>mac电脑可以正确解析 0.0.0.0 ，所以可以正常打开网页，但window不能对 0.0.0.0 进行正确的解析，所以无法打开网页</li></ul></li></ul> <p><strong>port</strong> 设置监听的窗口，默认情况下是8080；</p> <p><strong>open</strong> 是否打开浏览器：</p> <ul><li>默认值是false，设置为true会打开浏览器；</li> <li>也可以设置为类似于 Google Chrome 等值；</li></ul> <p><strong>compress</strong> 是否为静态文件开启gzip compression：</p> <ul><li>默认值是false，可以设置为true；</li> <li>为true时会将资源文件压缩为gzip；</li> <li>但是一般不启用，这是本地开发环境内的属性，文件在本地的读取速度已经很快了，没必要把文件压缩之后放进内存，再从内存中解压读取，这样做的话反而可能更加耗费性能；</li></ul> <p><strong>proxy</strong> 是我们开发中非常常用的一个配置选项，它的目的是设置代理来解决 <strong>跨域访问</strong> 的问题：</p> <ul><li>比如我们的一个api请求是 http://localhost:8888 ，但是本地启动服务器的域名是 http://localhost:8000 ，这个时候发送网络请求就会出现跨域的问题；</li> <li>那么我们可以将请求先发送到一个代理服务器，代理服务器和API服务器没有跨域的问题，就可以解决我们的跨域问题了；</li></ul> <p><strong>proxy</strong> 对象的配置如下：</p> <ul><li><p>target : 表示的是代理到的目标地址，比如 /api/moment 会被代理到 http://localhost:8888/api/moment ；</p> <ul><li>target有些特殊</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">//...</span>
  devServer<span class="token operator">:</span> <span class="token punctuation">{</span>
    proxy<span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token comment">// 语法糖</span>
      <span class="token comment">// '/api': 'http://localhost:3000',</span>
      <span class="token string">'/api'</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        target<span class="token operator">:</span> <span class="token string">'http://localhost:3000'</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><ul><li><p>对/api/users的请求现在将代理该请求到 http://localhost:3000/api/users ,</p> <p>如果你不希望/api被传递(路径中出现/api)，我们需要重写路径:</p></li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">//...</span>
  devServer<span class="token operator">:</span> <span class="token punctuation">{</span>
    proxy<span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token string">'/api'</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        target<span class="token operator">:</span> <span class="token string">'http://localhost:3000'</span><span class="token punctuation">,</span>
        pathRewrite<span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token string">'^/api'</span><span class="token operator">:</span> <span class="token string">''</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div></li> <li><p>pathRewrite : 默认情况下，我们的 /api 也会被写入到URL中，如果希望删除，可以使用pathRewrite；</p></li> <li><p>secure : 默认情况下，在HTTPS上运行的带有无效证书的后端服务器将不被接受，如果希望支持，可以设置为false；</p></li> <li><p>changeOrigin :  它表示是否更新代理后请求的headers中的host；</p></li></ul> <p>coderwhy老师对changeOrigin的解析：</p> <ul><li>这个changeOrigin官方说的非常模糊，通过查看源码我发现其实是要修改代理请求中的headers中的host属性：
<ul><li>因为我们真实的请求，其实是需要通过 http://localhost:8888 来请求的；</li> <li>但是因为使用了代码，默认情况下它的值是 http://localhost:8000 ；</li> <li>如果我们需要修改，那么可以将changeOrigin设置为true即可；</li></ul></li></ul> <p>即在配置文件中，原接口设置为8888，代理后是8000，需要修改让二者统一则可以将changeOrigin设置为true。</p> <p><strong>historyApiFallback</strong> 是开发中一个非常常见的属性，它主要的作用是解决SPA页面在路由跳转之后，进行页面刷新时，返回404的错误。</p> <p>boolean值：默认是false</p> <ul><li>如果设置为true，那么在刷新后，返回404错误时，会自动返回 index.html 的内容；</li></ul> <p>object类型的值，可以配置rewrites属性：</p> <ul><li>可以配置from来匹配路径，决定要跳转到哪一个页面；</li></ul> <p>事实上devServer中实现historyApiFallback功能是通过connect-history-api-fallback库的：</p> <ul><li>可以查看 <a href="https://github.com/bripkens/connect-history-api-fallback" target="_blank" rel="noopener noreferrer">connect-history-api-fallback<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 文档</li></ul> <h3 id="resolve模块解析"><a href="#resolve模块解析" class="header-anchor">#</a> resolve模块解析</h3> <p>resolve用于设置模块如何被解析：</p> <ul><li>在开发中我们会有各种各样的模块依赖，这些模块可能来自于自己编写的代码，也可能来自第三方库；</li> <li>resolve可以帮助webpack从每个 require/import 语句中，找到需要引入的合适的模块代码；</li> <li>webpack使用 <a href="https://github.com/webpack/enhanced-resolve" target="_blank" rel="noopener noreferrer">enhanced-resolve<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 来解析文件路径；</li></ul> <p>webpack能解析三种文件路径：</p> <ul><li>绝对路径
<ul><li>由于已经获得文件的绝对路径，因此不需要再做进一步解析。</li></ul></li> <li>相对路径
<ul><li>在这种情况下，使用 import 或 require 的资源文件所处的目录，被认为是上下文目录</li> <li>在 import/require 中给定的相对路径，会拼接此上下文路径，来生成模块的绝对路径；</li></ul></li> <li>模块路径
<ul><li>在 resolve.modules 中指定的所有目录检索模块；
<ul><li>默认值是['node_modules'], 所以默认会从node_modules中查找文件；</li></ul></li> <li>我们可以通过设置别名的方式来替换初始模块路径；</li></ul></li></ul> <p>确定文件还是文件名：</p> <ul><li>如果是一个文件：
<ul><li>如果文件具有扩展名，则直接打包文件；</li> <li>否则，将使用 resolve.extensions 选项作为文件扩展名解析；</li></ul></li> <li>如果是一个文件夹：
<ul><li>会在文件夹中根据 resolve.mainFiles 配置选项中指定的文件顺序查找；
<ul><li>resolve.mainFiles 的默认值是['index'] ;</li> <li>再根据 resolve.extensions 来解析扩展名；</li></ul></li></ul></li></ul> <p><strong>extensions</strong> 是resolve的一个属性，存放着一个数组，里面是解析到文件时会被自动添加的扩展名：</p> <ul><li>默认值是['.wasm', '.mjs', '.js', '.json']</li> <li>所以如果我们想要不写扩展名，让webpack自动帮我们添加 .vue 、.jsx、.ts等后缀时，我们需要修改 extensions</li> <li>['.wasm', '.mjs', '.js', '.json', '.vue', '.jsx', '.ts']</li></ul> <p>另一个非常好用的功能是配置别名 <strong>alias</strong> ：</p> <ul><li>特别是当我们项目的目录结构比较深的时候，或者一个文件的路径可能需要 ../../../ 这种路径片段；</li> <li>我们可以给某些常见的路径起一个别名；</li></ul> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// webpack.config.js</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;path&quot;</span><span class="token punctuation">)</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token punctuation">.</span>
  resolve<span class="token operator">:</span> <span class="token punctuation">{</span>
    extensions<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'.wasm'</span><span class="token punctuation">,</span> <span class="token string">'.mjs'</span><span class="token punctuation">,</span> <span class="token string">'.js'</span><span class="token punctuation">,</span> <span class="token string">'.json'</span><span class="token punctuation">,</span> <span class="token string">'.vue'</span><span class="token punctuation">,</span> <span class="token string">'.jsx'</span><span class="token punctuation">,</span> <span class="token string">'.ts'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    alias<span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token string">&quot;@&quot;</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&quot;./src&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token string">&quot;js&quot;</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&quot;./src/js&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h2 id="拆分webpack-config-js"><a href="#拆分webpack-config-js" class="header-anchor">#</a> 拆分webpack.config.js</h2> <p>目前我们所有的webpack配置信息都是放到一个配置文件中的：webpack.config.js</p> <ul><li>当配置越来越多时，这个文件会变得越来越不容易维护；</li> <li>并且某些配置是在开发环境需要使用的，某些配置是在生成环境需要使用的，当然某些配置是在开发和生成环境都会使用的；</li> <li>所以，我们最好对配置进行划分，方便我们维护和管理；</li></ul> <p>那么，如何在启动时使用不同的配置呢？</p> <p>有两个方案：</p> <ol><li>编写两个不同的配置文件，开发和生成时，分别加载不同的配置文件即可；</li> <li>使用相同的一个入口配置文件，通过设置参数来区分它们；</li></ol> <p>方案1较为简单，不做赘述。</p> <p>下面讲方案2</p> <p>大概思路：</p> <p>在根目录创建一个config文件夹，在里面再创建3个文件：</p> <ul><li>webpack.comm.config.js</li> <li>webpack.dev.config.js</li> <li>webpack.prod.config.js</li></ul> <p>将原webpack.config.js文件中的通用配置抽出，放入 webpack.comm.config.js 文件中，将开发配置抽出，放入 webpack.dev.config.js 文件中，将生成配置抽出，放入 webpack.prod.config.js 文件中；</p> <p>使用 <strong>webpack-merge</strong> 将 webpack.comm.config.js 分别引入开发和生成配置文件中；</p> <p>修改package.json脚本指令：</p> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token comment">// package.json</span>
<span class="token property">&quot;scripts&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token property">&quot;build&quot;</span><span class="token operator">:</span> <span class="token string">&quot;webpack --config ./config/webpack.prod.config.js&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;serve&quot;</span><span class="token operator">:</span> <span class="token string">&quot;webpack serve --config ./config/webpack.dev.config.js&quot;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>另外，由于三份文件被放置于config文件夹中，不像 webpack.config.js 一样位于根目录中，所以部分路径需要修改：</p> <p>我们之前编写入口文件的规则是这样的：./src/index.js，但是如果我们的配置文件所在的位置变成了 config 目录， 我们是否应该变成 ../src/index.js呢？</p> <ul><li>我所使用的webpack版本，是需要变成 ../src/index.js的。</li></ul> <p><strong>context</strong> 的作用是用于解析入口（entry point）和加载器（loader）：</p> <ul><li>官方说法：默认是当前路径（但是经过coderwhy老师测试，默认应该是webpack的启动目录）</li> <li>另外推荐在配置中传入一个值；</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  context<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&quot;./&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  entry<span class="token operator">:</span> <span class="token string">&quot;../src/index.js&quot;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  context<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&quot;../&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  entry<span class="token operator">:</span> <span class="token string">&quot;./src/index.js&quot;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><strong>下面的拆分的三份配置文件的代码：</strong></p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// webpack.comm.config.js</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;path&quot;</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> HtmlWebpackPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;html-webpack-plugin&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> DefinePlugin <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;webpack&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> VueLoaderPlugin <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;vue-loader/dist/index&quot;</span><span class="token punctuation">)</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  target<span class="token operator">:</span> <span class="token string">&quot;web&quot;</span><span class="token punctuation">,</span>
  entry<span class="token operator">:</span> <span class="token string">&quot;@/index.js&quot;</span><span class="token punctuation">,</span>
  output<span class="token operator">:</span> <span class="token punctuation">{</span>
    path<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&quot;../dist&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    filename<span class="token operator">:</span> <span class="token string">&quot;js/main.js&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">// watch: true,</span>
  resolve<span class="token operator">:</span> <span class="token punctuation">{</span>
    extensions<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'.wasm'</span><span class="token punctuation">,</span> <span class="token string">'.mjs'</span><span class="token punctuation">,</span> <span class="token string">'.js'</span><span class="token punctuation">,</span> <span class="token string">'.json'</span><span class="token punctuation">,</span> <span class="token string">'.vue'</span><span class="token punctuation">,</span> <span class="token string">'.jsx'</span><span class="token punctuation">,</span> <span class="token string">'.ts'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    alias<span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token string">&quot;@&quot;</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&quot;../src&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token string">&quot;js&quot;</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&quot;../src/js&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  module<span class="token operator">:</span> <span class="token punctuation">{</span>
    rules<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.vue$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        loader<span class="token operator">:</span> <span class="token string">&quot;vue-loader&quot;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.js$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        loader<span class="token operator">:</span> <span class="token string">&quot;babel-loader&quot;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.css$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        use<span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token string">&quot;style-loader&quot;</span><span class="token punctuation">,</span>
          <span class="token string">&quot;css-loader&quot;</span><span class="token punctuation">,</span>
          <span class="token string">&quot;postcss-loader&quot;</span>
        <span class="token punctuation">]</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.less$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        use<span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token string">&quot;style-loader&quot;</span><span class="token punctuation">,</span>
          <span class="token string">&quot;css-loader&quot;</span><span class="token punctuation">,</span>
          <span class="token string">&quot;less-loader&quot;</span>
        <span class="token punctuation">]</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.(jpe?g|png|gif|svg)$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        type<span class="token operator">:</span> <span class="token string">&quot;asset&quot;</span><span class="token punctuation">,</span>
        generator<span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token comment">// 不能folder</span>
          filename<span class="token operator">:</span> <span class="token string">&quot;img/[name]_[hash:6][ext]&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        parser<span class="token operator">:</span> <span class="token punctuation">{</span>
          dataUrlCondition<span class="token operator">:</span> <span class="token punctuation">{</span>
            maxSize<span class="token operator">:</span> <span class="token number">100</span><span class="token operator">*</span><span class="token number">1024</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>

      <span class="token punctuation">{</span>
        test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.(eot|ttf|woff2?)$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        type<span class="token operator">:</span> <span class="token string">&quot;asset/resource&quot;</span><span class="token punctuation">,</span>
        generator<span class="token operator">:</span> <span class="token punctuation">{</span>
          filename<span class="token operator">:</span> <span class="token string">&quot;font/[name]_[hash:6][ext]&quot;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>

    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">HtmlWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      title<span class="token operator">:</span> <span class="token string">&quot;webpack_plugins&quot;</span><span class="token punctuation">,</span>
      template<span class="token operator">:</span> <span class="token string">&quot;./public/index.html&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword">new</span> <span class="token class-name">DefinePlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token comment">// 这里需要双引号和单引号一起</span>
      <span class="token constant">BASE_URL</span><span class="token operator">:</span> <span class="token string">&quot;'./'&quot;</span><span class="token punctuation">,</span>
      <span class="token comment">// 是否兼容vue2的options(是否下载适配vue2的代码)</span>
      __VUE_OPTIONS_API__<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      <span class="token comment">// 是否在生产环境使用测试工具devtool</span>
      __VUE_PROD_DEVTOOLS__<span class="token operator">:</span> <span class="token boolean">false</span>

    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword">new</span> <span class="token class-name">VueLoaderPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br></div></div><div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// webpack.dev.config.js</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;path&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> merge <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'webpack-merge'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> commonConfig <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./webpack.comm.config'</span><span class="token punctuation">)</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token function">merge</span><span class="token punctuation">(</span>commonConfig<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token comment">// 设置模式</span>
  <span class="token comment">// development 开发阶段，会设置development</span>
  <span class="token comment">// production 准备打包上线的时候，设置production</span>
  mode<span class="token operator">:</span> <span class="token string">&quot;development&quot;</span><span class="token punctuation">,</span>
  <span class="token comment">// 设置source-map, 建立js映射文件，方便调试代码和错误</span>
  devtool<span class="token operator">:</span> <span class="token string">&quot;source-map&quot;</span><span class="token punctuation">,</span>  
  devServer<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token keyword">static</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      directory<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'../abc'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    hot<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    host<span class="token operator">:</span> <span class="token string">'127.0.0.1'</span><span class="token punctuation">,</span>
    port<span class="token operator">:</span> <span class="token number">7777</span><span class="token punctuation">,</span>
    <span class="token comment">// open: true,</span>
    <span class="token comment">// compress: true</span>
    proxy<span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token string">&quot;/api&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        target<span class="token operator">:</span> <span class="token string">&quot;http://localhost:8888&quot;</span><span class="token punctuation">,</span>
        pathRewrite<span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token string">&quot;^/api&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        secure<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
        changeOrigin<span class="token operator">:</span> <span class="token boolean">true</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br></div></div><div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// webpack.prod.config.js</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> CleanWebpackPlugin <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;clean-webpack-plugin&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> CopyWebpackPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;copy-webpack-plugin&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> merge <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'webpack-merge'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> commonConfig <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./webpack.comm.config'</span><span class="token punctuation">)</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token function">merge</span><span class="token punctuation">(</span>commonConfig<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token comment">// 设置模式</span>
  <span class="token comment">// development 开发阶段，会设置development</span>
  <span class="token comment">// production 准备打包上线的时候，设置production</span>
  mode<span class="token operator">:</span> <span class="token string">&quot;production&quot;</span><span class="token punctuation">,</span>
  plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">CleanWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword">new</span> <span class="token class-name">CopyWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      patterns<span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
          from<span class="token operator">:</span> <span class="token string">&quot;public&quot;</span><span class="token punctuation">,</span>
          globOptions<span class="token operator">:</span> <span class="token punctuation">{</span>
            ignore<span class="token operator">:</span> <span class="token punctuation">[</span>
              <span class="token string">&quot;**/index.html&quot;</span>
            <span class="token punctuation">]</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><h2 id="参考"><a href="#参考" class="header-anchor">#</a> 参考</h2> <p><a href="https://ke.qq.com/course/3453141" target="_blank" rel="noopener noreferrer">深入Vue3+TypeScript技术栈-coderwhy<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></div></div> <div class="page-slot page-slot-bottom"><!-- 横向自适应 -->
      <ins class="adsbygoogle"
          style="display:block"
          data-ad-client="ca-pub-7828333725993554"
          data-ad-slot="6620245489"
          data-ad-format="auto"
          data-full-width-responsive="true"></ins>
      <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
      </script></div> <div class="page-edit"><div class="edit-link"><a href="https://github.com/zzwi/edit/master/docs/Vue笔记/20.Vue3学习/11.Webpack5(part2).md" target="_blank" rel="noopener noreferrer">编辑</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="tags"><a href="/tags/?tag=Vue" title="标签">#Vue</a></div> <!----></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/pages/f3a2be/" class="page-nav-centre page-nav-centre-prev"><div class="tooltip">Webpack5(part1)</div></a> <a href="/pages/5d8eed/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">VueCLI和Vite</div></a></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/pages/f3a2be/" class="prev">Webpack5(part1)</a></span> <span class="next"><a href="/pages/5d8eed/">VueCLI和Vite</a>→
      </span></p></div></div></div> <div class="article-list"><div class="article-title"><a href="/archives/" class="iconfont icon-bi">最近更新</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/pages/e633e5/"><div>Vue3-动画实现</div></a> <span>05-29</span></dt></dl><dl><dd>02</dd> <dt><a href="/pages/2861f2/"><div>Vue3组件化开发(part3)</div></a> <span>05-24</span></dt></dl><dl><dd>03</dd> <dt><a href="/pages/55ab04/"><div>Vue3组件化开发(part2)</div></a> <span>05-19</span></dt></dl> <dl><dd></dd> <dt><a href="/archives/" class="more">更多文章&gt;</a></dt></dl></div></div></main></div> <div class="footer"><div class="icons"><a href="mailto:2065210282@qq.com" title="发邮件" target="_blank" class="iconfont icon-youjian"></a><a href="https://github.com/zzwi" title="GitHub" target="_blank" class="iconfont icon-github"></a><a href="https://music.163.com/#/playlist?id=755597173" title="听音乐" target="_blank" class="iconfont icon-erji"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
    | Copyright © 2021-2022
    <span>Zzwi | Powered by <a href="https://webify.cloudbase.net/" target="_blank">CloudBase Webify</a></span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <!----> <!----> <div class="custom-html-window custom-html-window-rb" style="display:;"><div class="custom-wrapper"><i class="close-but">×</i> <div><!-- 固定160*160px -->
      <ins class="adsbygoogle"
          style="display:inline-block;max-width:160px;max-height:160px"
          data-ad-client="ca-pub-7828333725993554"
          data-ad-slot="8377369658"></ins>
      <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
      </script>
      </div></div></div></div><div class="global-ui"><div></div></div></div>
    <script src="/assets/js/app.71e14a09.js" defer></script><script src="/assets/js/2.4c3fdaa0.js" defer></script><script src="/assets/js/78.61acab51.js" defer></script>
  </body>
</html>